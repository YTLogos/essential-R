<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap/shim/respond.min.js"></script>
<script src="site_libs/jqueryui/jquery-ui.min.js"></script>
<link href="site_libs/tocify/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify/jquery.tocify.js"></script>
<script src="site_libs/navigation/tabsets.js"></script>
<script src="site_libs/htmlwidgets/htmlwidgets.js"></script>
<script src="site_libs/d3/d3.min.js"></script>
<link href="site_libs/profvis/profvis.css" rel="stylesheet" />
<script src="site_libs/profvis/profvis.js"></script>
<link href="site_libs/highlight/textmate.css" rel="stylesheet" />
<script src="site_libs/highlight/highlight.js"></script>
<script src="site_libs/profvis-binding/profvis.js"></script>
<script src="site_libs/plotly-binding/plotly.js"></script>
<script src="site_libs/typedarray/typedarray.min.js"></script>
<link href="site_libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="theme.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}

.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Essential R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dirmeier/essential-R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/simon_dirmeier/">
    <span class="fa fa fa fa-twitter-square fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div style="margin-top: 5%">


<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> Intro</h1>
<div>
<p><i>Programs must be written for people to read, and only incidentally for machines to execute.</i></p>
</div>
<div class="quote">
<p>– Harold Abelson</p>
</div>
<div style="margin-top: 2%">
<p><i>The lyf so short, the craft so long to lerne.</i></p>
</div>
<div class="quote" style="margin-bottom: 5%">
<p>– Geoffrey Chaucer</p>
</div>
<p>These slides are a rough guideline of how to write <code>R</code> code using common software, such as <code>devtools</code>, <code>testthat</code>, <code>lintr</code>, <code>covr</code>, <code>data.table</code>, <code>Rcpp</code> and its derivates, and other frequently used tools to program in <code>R</code>. We don’t claim at any point that the material treated here covers all of R, but rather serve as a the author’s list of essential <code>R</code> tools he frequently uses.</p>
<p>These slides are no introduction on how to program functionally, procedurally or in an object-oriented way, how to write code in general, or how to speed it up. The interested reader is referred to:</p>
<ul>
<li>Robert Martin: Clean Code,</li>
<li>Andrew Hunt: The Pragmatic Programmer,</li>
<li>Gang of Four: Design Patterns,</li>
<li>Hadley Wickham: R packages,</li>
<li>Hadley Wickham: Advanced R,</li>
<li>Dirk Eddelbuettel: Seamless R and C++ Integration with Rcpp,</li>
<li>Thomas Cormen: Introduction to Algorithms,</li>
<li>Dan Gusfield: Algorithms on Strings, Trees and Sequences,</li>
<li>Donald Knuth: The Art of Computer Programming,</li>
<li>A <a href="http://norvig.com/21-days.html">comment</a> by Peter Norvig.</li>
</ul>
</div>
<div id="r-development" class="section level1">
<h1><span class="header-section-number">2</span> R development</h1>
<p>The following section covers tools that help and speed up developing R:</p>
<ul>
<li><code>yeoman</code></li>
<li><code>devtools</code></li>
<li><code>testthat</code></li>
<li><code>roxygen2</code></li>
<li><code>covr</code></li>
<li><code>lintr</code></li>
<li><code>usethis</code></li>
</ul>
<div id="creating-r-packages" class="section level2">
<h2><span class="header-section-number">2.1</span> Creating R packages</h2>
<p>If you have <code>yeoman</code> installed, you can use the <code>R-bones</code> generator in order to initialize a complete project. This gives you the following barebone:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">yo</span> r-bones
  <span class="kw">ls</span> -la newpkg</code></pre></div>
<pre><code>total 1624
drwxr-xr-x  26 simondi  1029     884 Jan 24 19:19 .
drwxr-xr-x  32 simondi  1029    1088 Jan 24 21:45 ..
-rw-r--r--   1 simondi  1029     220 Jan 22 20:24 .Rbuildignore
drwxr-xr-x   4 simondi  1029     136 Jan 23 20:32 .Rproj.user
-rw-r--r--   1 simondi  1029     410 Jan 22 20:24 .codecov.yml
-rw-r--r--   1 simondi  1029      51 Jan 22 20:24 .gitattributes
-rw-r--r--   1 simondi  1029     421 Jan 22 20:24 .gitignore
-rw-r--r--   1 simondi  1029     556 Jan 22 20:24 .lintr
-rw-r--r--   1 simondi  1029     829 Jan 23 15:44 .travis.yml
-rw-r--r--   1 simondi  1029     176 Jan 22 20:24 .yo-rc.json
-rw-r--r--   1 simondi  1029     548 Jan 23 20:31 DESCRIPTION
-rw-r--r--   1 simondi  1029   35141 Jan 22 20:24 LICENSE
-rw-r--r--   1 simondi  1029      56 Jan 23 20:47 NAMESPACE
drwxr-xr-x   4 simondi  1029     136 Jan 23 20:45 R
-rw-r--r--   1 simondi  1029     556 Jan 24 19:19 README.md
-rw-r--r--   1 simondi  1029      93 Jan 22 20:24 TODO.md
-rw-r--r--   1 simondi  1029     136 Jan 22 20:24 VERSIONS.md
-rw-r--r--   1 simondi  1029     836 Jan 22 20:24 appveyor.yml
drwxr-xr-x  11 simondi  1029     374 Jan 24 19:19 docs
drwxr-xr-x   3 simondi  1029     102 Jan 22 20:24 inst
drwxr-xr-x   3 simondi  1029     102 Jan 23 15:44 man
-rw-r--r--   1 simondi  1029     354 Jan 24 11:28 newpkg.Rproj
-rw-r--r--   1 simondi  1029  736082 Jan 23 20:42 newpkg.html
drwxr-xr-x   2 simondi  1029      68 Jan 23 20:47 src
drwxr-xr-x   4 simondi  1029     136 Jan 22 20:24 tests
drwxr-xr-x   3 simondi  1029     102 Jan 22 20:24 vignettes</code></pre>
</div>
<div id="writing-r-packages" class="section level2">
<h2><span class="header-section-number">2.2</span> Writing R packages</h2>
<p>When creating an R package <code>devtools</code> and <code>covr</code> covers almost any functionality required. The following functions delineate how my typical workflow looks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">create</span>(<span class="st">&quot;newpkg&quot;</span>)
devtools::<span class="kw">test</span>()
devtools::<span class="kw">document</span>()
devtools::<span class="kw">check_cran</span>()
devtools::<span class="kw">lint</span>()
devtools::<span class="kw">run_examples</span>()
covr::<span class="kw">package_coverage</span>()
devtools::<span class="kw">install</span>()
devtools::<span class="kw">use_rcpp</span>()</code></pre></div>
<p>This basically covers your complete development life cycle (except code coverage). <code>devtools</code> is <strong>tremendously</strong> useful. If you look for sth that helps you write packages, <code>devtools</code> has a function for it. For all other things, use <code>usethis</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">usethis::<span class="kw">use_namespace</span>()
usethis::<span class="kw">use_code_of_conduct</span>()
usethis::<span class="kw">use_travis</span>()
usethis::<span class="kw">use_vignette</span>()
usethis::<span class="kw">use_gpl3_license</span>()</code></pre></div>
</div>
<div id="testing-code" class="section level2">
<h2><span class="header-section-number">2.3</span> Testing code</h2>
<p>Right after creating your package, you should write your first test (yes, really). Testing is <strong>essential</strong> for writing good software. The same way as programming languages change your way of thinking, do unit tests change your way of writing functions. <code>testthat</code> is probably the best way to go here. Tests are usually put in <code>tests/testthat</code>. You can use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">use_testthat</span>()</code></pre></div>
<p>to create a test suite automatically. A test would look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">testthat::<span class="kw">test_that</span>(<span class="st">&quot;i know my math&quot;</span>, {
    testthat::<span class="kw">expect_equal</span>(<span class="kw">g</span>(), <span class="dv">2</span>)
})

testthat::<span class="kw">test_that</span>(<span class="st">&quot;i know my math&quot;</span>, {
    testthat::<span class="kw">expect_false</span>(<span class="st">&quot;wrong&quot;</span> ==<span class="st"> &quot;right&quot;</span>)
})</code></pre></div>
<p>Let’s test this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">test</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<pre><code>✔ | OK F W S | Context

⠏ |  0       | hello
⠋ |  1       | hello
⠙ |  2       | hello
✔ |  2       | hello

══ Results ════════════════════════════════════════════════════════════════
OK:       2
Failed:   0
Warnings: 0
Skipped:  0

Way to go!</code></pre>
<p>A function ideally does <em>one task and one task only</em>. Functions with side effects, multiple operations or exceedingly large method body easily introduce bugs. Keep your functions concise! This also simplifies testing, because it is easier to track down a bug in a shorter function.</p>
</div>
<div id="documenting-code" class="section level2">
<h2><span class="header-section-number">2.4</span> Documenting code</h2>
<p>Having written the first unit test, we can create the actual function for it <strong>and</strong> its documentation using <code>roxygen2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; @title Adds 1 and 1</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @description This magnificent function computes the sum of 1 and 1.</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @export  </span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @return  returns 2</span>
<span class="co">#&#39;  </span>
<span class="co">#&#39; @examples</span>
<span class="co">#&#39;   a &lt;- g()</span>
<span class="co">#&#39;   print(a)</span>
g &lt;-<span class="st"> </span>function() <span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span></code></pre></div>
<p>Then build the documentation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">document</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<p>An excellent help for creating documentation (of S3 and S4) is for instance <a href="https://github.com/variani/pckdev">pckdev</a> or the official <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/roxygen2.html">vignette</a>.</p>
</div>
<div id="checking-code" class="section level2">
<h2><span class="header-section-number">2.5</span> Checking code</h2>
<p>If you want to submit your package to <code>CRAN</code> or <code>Bioconductor</code> certain criteria must be fulfilled. Some of which can be tested by checking or package like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">check_cran</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<pre><code>Checking 1 CRAN packages =================================================</code></pre>
<pre><code>Results saved in /var/folders/cx/v45t2v2n6b548_vfn76vnzlw0050sr/T//RtmpBLPQQw/check_cran7086f5454f7</code></pre>
<pre><code>Package library: /private/var/folders/cx/v45t2v2n6b548_vfn76vnzlw0050sr/T/RtmpBLPQQw/R-lib, /Library/Frameworks/R.framework/Versions/3.4/Resources/library</code></pre>
<pre><code>Installing dependencies --------------------------------------------------</code></pre>
<pre><code>Installing 1 packages: ./newpkg</code></pre>
<pre><code>Skipping 1 packages without source:./newpkg</code></pre>
<pre><code>Checking packages --------------------------------------------------------</code></pre>
<pre><code>Checking 0 packages: </code></pre>
<pre><code>Package library: /private/var/folders/cx/v45t2v2n6b548_vfn76vnzlw0050sr/T/RtmpBLPQQw/R-lib, /Library/Frameworks/R.framework/Versions/3.4/Resources/library</code></pre>
<pre><code>NULL</code></pre>
<p>This does not test for Bioconductor though. For this you have to install <a href="https://bioconductor.org/packages/release/bioc/html/BiocCheck.html"> BioCheck</a> manually and call <code>R CMD BiocCheck newpkg*.tar</code> on the command line.</p>
</div>
<div id="static-code-analysis" class="section level2">
<h2><span class="header-section-number">2.6</span> Static code analysis</h2>
<p><code>lintr</code> checks your code for style, syntax error and possible issues. You can also incorporate <code>lintr</code> in your unit tests and let them fail, if lints are discovered.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="kw">requireNamespace</span>(<span class="st">&quot;lintr&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {
    <span class="kw">test_that</span>(<span class="st">&quot;this is lint free&quot;</span>, {
        lintr::<span class="kw">expect_lint_free</span>()
    })
}</code></pre></div>
<p>What <code>lintr</code> considers worth reporting can be customized in a <code>.lintr</code> file in your package root directory.</p>
<p>Let’s see if our small package is lint free:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">lint</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<pre><code>Linting newpkg....</code></pre>
<pre><code>R/bad_bad_file.R:3:1: style: lines should not be more than 80 characters.
                                                                              myRet = a+b
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
R/bad_bad_file.R:3:79: style: Variable and function names should be all lowercase.
                                                                              myRet = a+b
                                                                              ^~~~~
R/bad_bad_file.R:3:85: style: Use &lt;-, not =, for assignment.
                                                                              myRet = a+b
                                                                                    ^</code></pre>
<p>Whoops!</p>
</div>
<div id="running-examples" class="section level2">
<h2><span class="header-section-number">2.7</span> Running examples</h2>
<p>Examples are extremely helpful both for the user and debugging purposes. When we documented our function <code>g</code> we already have an example how to use the function. We can manually call all examples using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">run_examples</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<pre><code>Updating newpkg documentation</code></pre>
<pre><code>Loading newpkg</code></pre>
<pre><code>Running 1 example files in newpkg ----------------------------------------</code></pre>
<pre><code>Loading newpkg</code></pre>
<pre><code>Running examples in g.Rd -------------------------------------------------</code></pre>
<pre><code>&gt; 
&gt;   a &lt;- g()
&gt;   print(a)
[1] 2</code></pre>
<pre><code>Loading newpkg</code></pre>
</div>
<div id="code-coverage" class="section level2">
<h2><span class="header-section-number">2.8</span> Code coverage</h2>
<p><code>covr</code> lets you check how much of your code is used and tested. If you created a package just run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">covr::<span class="kw">package_coverage</span>(<span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<pre><code>newpkg Coverage: 50.00%</code></pre>
<pre><code>R/bad_bad_file.R: 0.00%</code></pre>
<pre><code>R/newpkg.R: 100.00%</code></pre>
<p>Having high code coverage usually correlates with a good testing suite. The more functionality is tested, the larger the code coverage.</p>
</div>
<div id="profiling-and-benchmarking" class="section level2">
<h2><span class="header-section-number">2.9</span> Profiling and benchmarking</h2>
<p>If you think your code runs slowly, you can try to find the bottleneck, for instance, using <code>profvis</code> and <code>microbenchmark</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;profvis&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gam&quot;</span>)
<span class="kw">data</span>(kyphosis)
profvis::<span class="kw">profvis</span>({
    sp &lt;-<span class="st"> </span>stats::<span class="kw">spline</span>(kyphosis$Age, kyphosis$Number, <span class="dt">method =</span> <span class="st">&quot;n&quot;</span>)
    gm &lt;-<span class="st"> </span>gam::<span class="kw">gam</span>(Number ~<span class="st"> </span>Age, <span class="dt">family =</span> poisson, <span class="dt">data =</span> kyphosis)
    
    df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">X =</span> <span class="kw">c</span>(sp$x, kyphosis$Age), <span class="dt">Y =</span> <span class="kw">c</span>(sp$y, <span class="kw">predict</span>(gm, kyphosis)), 
        <span class="dt">model =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Spline&quot;</span>, <span class="kw">length</span>(sp$x)), <span class="kw">rep</span>(<span class="st">&quot;GAM&quot;</span>, <span class="kw">length</span>(kyphosis$Age))))
    
    g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y, <span class="dt">color =</span> model)) +<span class="st"> </span><span class="kw">theme_void</span>()
    
    <span class="kw">print</span>(g)
})</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="384" /><div id="htmlwidget-11eb63cb86127721f8cf" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-11eb63cb86127721f8cf">{"x":{"message":{"prof":{"time":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"depth":[18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,12,11,10,9,8,7,6,5,4,3,2,1,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,14,13,12,11,10,9,8,7,6,5,4,3,2,1,10,9,8,7,6,5,4,3,2,1,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],"label":["eval","match.arg","order","NextMethod","[.factor","[","sort.default","sort","id_var","plyr::id","add_group","f","l$compute_aesthetics","f","by_layer","ggplot_build","print.ggplot","print","diff.default","diff","f","self$get_breaks_minor","f","<Anonymous>","f","scale_details$break_info","train_cartesian","f","coord$train","<Anonymous>","mapply","Map","f","layout$train_ranges","ggplot_build","print.ggplot","print","$<-","gtable_add_grob","gtable_matrix","f","self$draw_panels","f","<Anonymous>","f","layout$render","ggplot_gtable","print.ggplot","print","grid.Call","descentDetails.text","descentDetails","titleGrob","element_grob.element_text","element_grob","grobName","ggname","guide_gengrob.legend","FUN","lapply","guides_gengrob","build_guides","ggplot_gtable","print.ggplot","print","structure","valid.unit","unit","unit.c","Summary.unit","sum","FUN","lapply","do.call","guides_build","build_guides","ggplot_gtable","print.ggplot","print","names","names","vapply","f","Reduce","calc_element","element_render","ggplot_gtable","print.ggplot","print","%in%","stringUnit","dataUnit","recycle.data","lapply","sapply","valid.data","structure","valid.unit","unit","is.unit","viewport","<Anonymous>","mapply","makeContent.gtable","makeContent","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","print.ggplot","print","grid.Call.graphics","drawDetails.points","drawDetails","drawGrob","recordGraphics","grid.draw.grob","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","print.ggplot","print","sys.function","match.call","stopifnot","gtable_layout","valid.viewport","viewport","makeContext.gtable","makeContext","preDraw.gTree","preDraw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","NextMethod","grid.draw.absoluteGrob","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","print.ggplot","print","names<-","setChildren","makeContent.gtable","makeContent","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","drawGTree","recordGraphics","grid.draw.gTree","grid.draw","print.ggplot","print"],"filenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1],"linenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,13],"memalloc":[47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,47.5974578857422,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,48.0781860351562,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.2464370727539,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.4294357299805,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.6424102783203,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,49.8236541748047,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.0356826782227,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1052322387695,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.1925659179688,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383,50.3495559692383],"meminc":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.480728149414062,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.16825103759766,0,0,0,0,0,0,0,0,0,0,0,0.182998657226562,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.212974548339844,0,0,0,0,0,0,0,0,0,0,0,0,0,0.181243896484375,0,0,0,0,0,0,0,0,0,0.212028503417969,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.069549560546875,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0873336791992188,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.156990051269531,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"filename":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"<expr>"]},"interval":10,"files":[{"filename":"<expr>","content":"library(\"profvis\")\nlibrary(\"gam\")\ndata(kyphosis)\nprofvis::profvis({\n    sp <- stats::spline(kyphosis$Age, kyphosis$Number, method = \"n\")\n    gm <- gam::gam(Number ~ Age, family = poisson, data = kyphosis)\n    \n    df <- data.frame(X = c(sp$x, kyphosis$Age), Y = c(sp$y, predict(gm, kyphosis)), \n        model = c(rep(\"Spline\", length(sp$x)), rep(\"GAM\", length(kyphosis$Age))))\n    \n    g <- ggplot(df) + geom_point(aes(x = X, y = Y, color = model)) + theme_void()\n    \n    print(g)\n})","normpath":"<expr>"}],"prof_output":"/var/folders/cx/v45t2v2n6b548_vfn76vnzlw0050sr/T//RtmpBLPQQw/file708646a017f3.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script></p>
<p>Often it however suffices to just benchmark two methods against each other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span>function(n) {
    sum &lt;-<span class="st"> </span><span class="dv">0</span>
    for (i in <span class="kw">seq</span>(n)) sum &lt;-<span class="st"> </span>sum +<span class="st"> </span>i
}
g &lt;-<span class="st"> </span>function(.) <span class="kw">sum</span>(.)

microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">f</span>(<span class="dv">10000</span>), <span class="kw">g</span>(<span class="dv">10000</span>))</code></pre></div>
<pre><code>Unit: microseconds
     expr     min      lq      mean   median      uq      max neval cld
 f(10000) 286.447 287.229 324.78060 287.7505 288.957 3678.754   100   b
 g(10000)   1.196   1.496  14.00874   2.0615   2.557 1179.286   100  a </code></pre>
</div>
<div id="creating-a-landing-page" class="section level2">
<h2><span class="header-section-number">2.10</span> Creating a landing page</h2>
<p>At this point you are finished writing your package and you want to provide it to a large user base. A nice landing page often helps gaining popularity. The easiest way to do so is using <code>pkgdown</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgdown::<span class="kw">build_site</span>(<span class="dt">pkg =</span> <span class="st">&quot;./newpkg&quot;</span>)</code></pre></div>
<p>This creates a web-page like this:</p>
<div align="center">
<p><img src="https://rawgit.com/dirmeier/essential-R/master/fig/pkgdown.jpg" alt="oh no" width="500px"></p>
</div>
<p>A good example can be found <a href="https://dirmeier.github.io/netReg/">here</a>.</p>
</div>
</div>
<div id="good-practices" class="section level1">
<h1><span class="header-section-number">3</span> Good practices</h1>
<p>Continuous integration, version control and containerization are three of the many tools of a developer. Here, we quickly introduce how the three can be used for <code>R</code>.</p>
<div id="continuous-integration" class="section level2">
<h2><span class="header-section-number">3.1</span> Continuous integration</h2>
<p>Setting up continuous Integration: <code>Travis CI</code> and <code>AppVeyor</code></p>
<p>To be honest, doing all these steps is tedious and annoying. For that reason we set up <code>Travis CI</code> to take care of running our tests, static analysis and code coverage. Travis works for Mac and Unix.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> ./newpkg/.travis.yml</code></pre></div>
<pre><code>language: r

sudo: required
dist: trusty

cache: packages

matrix:
  include:
    - compiler: gcc
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-5
      env: COMPILER=g++-5
    - compiler: clang
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-precise-3.7
          packages:
            - clang-3.7
      env: COMPILER=clang++-3.7

env:
  global:
    - R_BUILD_ARGS=&quot;--no-build-vignettes --no-manual&quot;
    - R_CHECK_ARGS=&quot;--no-build-vignettes --no-manual --as-cran&quot;
    - LINTR_COMMENT_BOT=false

before_install:
  - cd newpkg

r_packages:
  - covr
  - testthat
  - lintr

after_script:
  - tar -C .. -xf $PKG_TARBALL
  - Rscript -e &#39;covr::codecov()&#39;
  - Rscript -e &#39;lintr::lint_package()&#39;</code></pre>
<p>Check out Travis’ <a href="https://docs.travis-ci.com/">docs</a> for more info. What we are basically telling Travis to do is to check our package <code>--as-cran</code>, run the unit tests, do the code coverage and finally do a static code analysis.</p>
<p>In order to do the same for Windows machines, we also use AppVeyor.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> ./newpkg/appveyor.yml</code></pre></div>
<pre><code># DO NOT CHANGE the &quot;init&quot; and &quot;install&quot; sections below

# Download script file from GitHub
init:
  ps: |
        $ErrorActionPreference = &quot;Stop&quot;
        Invoke-WebRequest http://raw.github.com/krlmlr/r-appveyor/master/scripts/appveyor-tool.ps1 -OutFile &quot;..\appveyor-tool.ps1&quot;
        Import-Module &#39;..\appveyor-tool.ps1&#39;

install:
  ps: Bootstrap

# Adapt as necessary starting from here

build_script:
  - travis-tool.sh install_deps

test_script:
  - travis-tool.sh run_tests

on_failure:
  - 7z a failure.zip *.Rcheck\*
  - appveyor PushArtifact failure.zip

artifacts:
  - path: &#39;*.Rcheck\**\*.log&#39;
    name: Logs

  - path: &#39;*.Rcheck\**\*.out&#39;
    name: Logs

  - path: &#39;*.Rcheck\**\*.fail&#39;
    name: Logs

  - path: &#39;*.Rcheck\**\*.Rout&#39;
    name: Logs

  - path: &#39;\*_*.tar.gz&#39;
    name: Bits

  - path: &#39;\*_*.zip&#39;
    name: Bits</code></pre>
<p>Here, we only run some tests and checks, since we already got the code analysis and coverage.</p>
<p>Code coverage of our project yielded us the following results:</p>
<div align="center">
<p><img src="https://codecov.io/gh/dirmeier/essential-R/branch/master/graphs/sunburst.svg" alt="no img"></p>
</div>
<div style="text-align: center">
<p>Code coverage</p>
</div>
<p>If we check the travis log, we see it has succeeded, because all tests ran through. However, we have some lints we should fix.</p>
<pre><code>$ tar -C .. -xf $PKG_TARBALL
after_script.2
2.22s$ Rscript -e 'covr::codecov()'
$message
[1] "Coverage reports upload successfully"
$id
[1] "552fd0db-187b-434e-b37b-a0e4fcba7636"
$meta
$meta$status
[1] 200
$queued
[1] TRUE
$url
[1] "https://codecov.io/github/dirmeier/essential-R/commit/f24d277296f78512524f26f3ca3b31d202e122a1"
$uploaded
[1] TRUE
after_script.3
1.23s$ Rscript -e 'lintr::lint_package()'
R/bad_bad_file.R:3:1: style: lines should not be more than 80 characters.
                                                                              myRet = a+b
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
R/bad_bad_file.R:3:79: style: Variable and function names should be all lowercase.
                                                                              myRet = a+b
                                                                              ^~~~~
R/bad_bad_file.R:3:85: style: Use <-, not =, for assignment.
                                                                              myRet = a+b
                                                                                    ^
Warning message:
In readLines(filename) :
  incomplete final line found on '/home/travis/build/dirmeier/essential-R/newpkg/R/emptypRoject-package.R'
Done. Your build exited with 0.</code></pre>
<p>Fixing style related issues is essential since we want other people to be able to read our code easily. Good code also increases the number of users, because the package is more trusted than a <em>spaghetti code</em> package.</p>
<div>
<p><i>Beauty is more important in computing than anywhere else in technology because software is so complicated. Beauty is the ultimate defense against complexity.</i></p>
</div>
<div class="quote" style="margin-bottom: 5%">
<p>– David Gelernter</p>
</div>
</div>
<div id="version-control" class="section level2">
<h2><span class="header-section-number">3.2</span> Version control</h2>
<p>Aside from he fact that version control is great, putting your project on <code>GitHub</code> has the most prominent advantage that you can add badges to your <code>README.md</code> to show others about the state of your package, for instance repository, CI or code coverage status.</p>
<div align="center">
<p><img src="https://rawgit.com/dirmeier/essential-R/master/fig/readme_me.jpg" alt="oh no" width="750px"></p>
</div>
There’s a wide variety of badges to describe your project.
<div align="center">
<table>
<thead>
<tr class="header">
<th>Description</th>
<th>Badge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Is the project passing on windows?</td>
<td><img src="https://ci.appveyor.com/api/projects/status/github/dirmeier/netReg?branch=master&svg=true"></td>
</tr>
<tr class="even">
<td>How long is it on Bioconductor?</td>
<td><img src="https://bioconductor.org/shields/years-in-bioc/netReg.svg" /></td>
</tr>
<tr class="odd">
<td>Is it installable using conda?</td>
<td><img src="https://anaconda.org/bioconda/netreg/badges/installer/conda.svg" /></td>
</tr>
<tr class="even">
<td>What is its version on CRAN?</td>
<td><img src="http://www.r-pkg.org/badges/version/datastructures?color=brightgreen" /></td>
</tr>
<tr class="odd">
<td>How often has it been downloaded?</td>
<td><img src="http://cranlogs.r-pkg.org/badges/grand-total/datastructures?color=brightgreen" /></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="docker" class="section level2">
<h2><span class="header-section-number">3.3</span> Docker</h2>
<p>todo (needed for debugging c++)</p>
</div>
</div>
<div id="r-libraries" class="section level1">
<h1><span class="header-section-number">4</span> R libraries</h1>
<p>Much of <code>R</code>’s popularity is due to its fantastic ecosystem. <code>R</code> users benefit heavily from CRAN and Bioconductor packages created by its community.</p>
<p>For data analysis or statistics <code>R</code> is a good choice for various reasons:</p>
<ul>
<li>high-level,</li>
<li>easy to install packages,</li>
<li>can be extended to <code>C++</code> without needing knowledge of linking or <code>C++</code> build-systems,</li>
<li>probably the best plotting facility with <code>ggplot</code>, <code>cowplot</code>, <code>hrbrthemes</code> or <code>ggsci</code>,</li>
<li>Bioconductor, machine learning and statistics libraries,</li>
<li>small standard library.</li>
</ul>
<p>There are a few things, however, <code>R</code> is not so great at:</p>
<ul>
<li>in general slow,</li>
<li>not really suited for large projects,</li>
<li>poor object orientation,</li>
<li>inconsistent function names,</li>
<li>superior IDEs for Java, Python, …,</li>
<li>very limited threading capabilities.</li>
</ul>
<div id="extending-to-c-using-rcpp" class="section level2">
<h2><span class="header-section-number">4.1</span> Extending to C++ using <code>Rcpp</code></h2>
<p>Using <code>Rcpp</code> (and <code>RcppEigen</code>, <code>RcppArmadillo</code>, <code>Boost</code>) you can easily your extend your code to C++. It not only nicely wraps the standard C API, but also let’s you use standard matrix libraries such as Eigen and Armadillo or Boost :heart_eyes:.</p>
<p>If you have a project that’s not a package you can for instance create a function like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rcpp::<span class="kw">cppFunction</span>(<span class="st">&quot;double sum(std::vector&lt;double&gt;&amp; vec) {</span>
<span class="st">      double sum = .0;</span>
<span class="st">      for (std::vector&lt;double&gt;::size_type i = 0; i &lt; vec.size(); ++i)</span>
<span class="st">          sum += vec[i];</span>
<span class="st">      return sum;</span>
<span class="st">  }&quot;</span>)

<span class="kw">sum</span>(<span class="kw">as.numeric</span>(<span class="kw">seq</span>(<span class="dv">10</span>)))</code></pre></div>
<pre><code>[1] 55</code></pre>
<p>Let’s see an <code>Eigen</code> example with sourceCpp:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> ./square.cpp</code></pre></div>
<pre><code>// [[Rcpp::depends(RcppEigen)]]
#include &lt;RcppEigen.h&gt;

// [[Rcpp::export]]
Eigen::MatrixXd square(Eigen::MatrixXd&amp; m)
{
    return m.transpose() * m;
}</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;RcppEigen&quot;</span>)
Rcpp::<span class="kw">sourceCpp</span>(<span class="st">&quot;./square.cpp&quot;</span>)
<span class="kw">square</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dv">2</span>))</code></pre></div>
<pre><code>          [,1]       [,2]       [,3]      [,4]      [,5]
[1,]  4.364522 -1.7760971  1.8366352  6.181937  5.164233
[2,] -1.776097  1.4528807 -0.4084714 -3.390821 -2.719012
[3,]  1.836635 -0.4084714  0.9302091  2.195169  1.886520
[4,]  6.181937 -3.3908210  2.1951693  9.805118  8.054789
[5,]  5.164233 -2.7190124  1.8865198  8.054789  6.632697</code></pre>
<p>Even for small matrices, the speed up is already substantial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span> *<span class="st"> </span><span class="dv">100</span>), <span class="dv">100</span>)
microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">square</span>(m), <span class="kw">t</span>(m) %*%<span class="st"> </span>m)</code></pre></div>
<pre><code>Unit: microseconds
       expr     min       lq     mean  median       uq      max neval cld
  square(m) 186.162 191.5030 255.6008 200.206 212.3675 1556.666   100  a 
 t(m) %*% m 628.448 637.0615 656.6949 642.684 649.0490 1340.997   100   b</code></pre>
<div id="rcpp-in-a-package" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Rcpp in a package</h3>
<p>Usually, you would want to put your source code into a <code>cpp</code> file in the <code>src</code> folder. Then you can call C++ from an R function, for instance as described below.</p>
<ol style="list-style-type: decimal">
<li>Define a C++ source file and put it in <code>src</code>, like this:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c">  <span class="ot">#include &lt;Rcpp.h&gt;</span>
  <span class="co">// [[Rcpp::export]]</span>
  Rcpp::List dostuff()
  {
    <span class="co">// some computations</span>

    <span class="kw">return</span> Rcpp::List::create(
      Rcpp::Named(<span class="st">&quot;a&quot;</span>) = ...
    );
  }</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Add this to your <code>DESCRIPTION</code>:</li>
</ol>
<pre><code>Imports: Rcpp
LinkingTo: Rcpp</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Add a comment <code>#' @useDynLib newpkg, .registration = TRUE</code> to the documentation of any function, better yet to the package doc.</p></li>
<li><p>Call <code>devtools::document()</code></p></li>
<li><p>Call <code>Rcpp::compileAttributes(&quot;./newpkg&quot;)</code></p></li>
</ol>
<p>This should let you access the C++ function from your package. For more details check out the main <a href="http://www.rcpp.org/">documentation</a> or some of my packages, like <a href="https://github.com/dirmeier/netReg">netReg</a> or <a href="https://github.com/dirmeier/datastructures">datastructures</a>. The latter also has an example how to use modules and Boost.</p>
</div>
<div id="writing-c" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Writing <code>C++</code></h3>
<p>Here are some tools that help you develop your code&quot;</p>
<ul>
<li><code>gdb</code> and <code>lldb</code> for debugging,</li>
<li><code>valgrind</code> and <code>gprof</code> to check for memory leaks and for profiling,</li>
<li>Intel’s <code>Parallel Studio XE</code> (&lt;3) which is a toolbox for vectorization, debugging, memory checks, etc. If you can get hold of it, get it. It is magnificent.</li>
<li><code>BOOST</code> for unit tests, data structures and basically everything you ever need,</li>
<li><code>cppcheck</code> for static code analysis,</li>
<li><code>doxygen</code> for code documentation.</li>
</ul>
<p>Many C++ libraries, like <code>Dlib</code>, <code>Eigen</code> or <code>tensorflow</code> have an R interface, so before implementing functionality yourself check out if there is already an implementation for it.</p>
<p>At this point it also makes sense to have a look at various <code>C++</code> books such as</p>
<ul>
<li>Scott Meyers: Effective Modern C++,</li>
<li>Scott Meyers: Effective C++,</li>
<li>Ben Klemens: 21. century C,</li>
<li>Kurt Guntheroth: Optimized C++,</li>
<li>Nicolai Josuttis: C++17 - the complete guide,</li>
<li>David Vandevoorde: C++ Templates - the compete guide.</li>
</ul>
<p>For fast numerical code OpenMP and advanced vector and streaming SIMD extensions (AVX/SSE) is often the way to go. Writing good code using AVX is however not very simple and knowledge of memory alignment is required. However, starting from version 4 (?), OpenMP easily allows vectorization using <code>#pragma simd</code>.</p>
<p><strong>Note: the last lines in this section are heavily subjective and only state the author’s opinion.</strong></p>
<p>More and more garbage code is forced onto the scientific community, mostly related to academic hubris and lack of knowledge about how to <em>program</em> (we don’t mean how to <em>accomplish a task using a programming language</em>, but to embrace a language and its philosophy at its very core). If you aim to publish your code, make sure it follows <em>contemporary</em> good practices, standards and guidelines and that it is consistent, for instance by following people’s code who are part of the community for ages. At this point we want to emphasize that the author doesn’t claim to know C++, but rather that he is annoyed by this very trend.</p>
<p>C++ is a large, complex language. Chances that you mess up, introduce bugs and memory leaks are high, unless you have some experience. In academia in mostly results in bad, un-maintainable code. If your argument is <em>but it is faster than R</em>, at least have a look at <code>Julia</code> or <code>Python</code> (and <code>numpy</code>). If you still prefer hacking in C++ try to stick to some guidelines:</p>
<ul>
<li>don’t include C headers in your C++ projects .. just don’t. C and C++ are <strong>two</strong> languages. There is for need for <code>FILE*</code> or <code>malloc</code>.</li>
<li>modern C++ rarely needs pointers. Use <code>std::vector</code> or <code>std::unique_ptr</code>. No need to manually release pointers is an advantage of itself.</li>
<li>BOOST has (probably) everything you will ever need. Don’t reinvent the wheel and learn to include libraries in your project.</li>
<li>Learn how to use Cmake, Meson or autotools. You should <strong>never</strong> need to directly invoke a compiler or write a hard-coded Makefile.</li>
<li>Only because you have a PhD or M. Sc. in CS does not make you a prolific programmer. It requires staying up to date, <strong>reading other people’s code</strong> and embracing of new ideas and the very philosophy of the language and its community.</li>
<li>Print warnings. They are usually there for a reason.</li>
<li>Start a toy project or contribute to OSS projects.</li>
</ul>
</div>
</div>
<div id="functional-programming-with-purrr" class="section level2">
<h2><span class="header-section-number">4.2</span> Functional programming with <code>purrr</code></h2>
<p><code>purrr</code> is a functional programming toolkit, much like the <code>apply</code> class of functions. However, <code>purrr</code> does so in a more unified way with consistent return values. Furthermore, in combination with <code>magrittr</code>, the code you write is naturally more concise and easier to read.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;purrr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;repurrrsive&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;magrittr&quot;</span>)
utils::<span class="kw">head</span>(sw_people[[<span class="dv">1</span>]])</code></pre></div>
<pre><code>$name
[1] &quot;Luke Skywalker&quot;

$height
[1] &quot;172&quot;

$mass
[1] &quot;77&quot;

$hair_color
[1] &quot;blond&quot;

$skin_color
[1] &quot;fair&quot;

$eye_color
[1] &quot;blue&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(sw_people, <span class="dt">.f =</span> function(.) <span class="kw">data.frame</span>(<span class="dt">color =</span> .[[<span class="st">&quot;eye_color&quot;</span>]], 
    <span class="dt">height =</span> .[[<span class="st">&quot;height&quot;</span>]], <span class="dt">mass =</span> .[[<span class="st">&quot;mass&quot;</span>]]))
utils::<span class="kw">head</span>(df)</code></pre></div>
<pre><code>   color height mass
1   blue    172   77
2 yellow    167   75
3    red     96   32
4 yellow    202  136
5  brown    150   49
6   blue    178  120</code></pre>
</div>
<div id="plotting" class="section level2">
<h2><span class="header-section-number">4.3</span> Plotting</h2>
<p>One of the most significant reasons to use R is probably its plotting capabilities and people contributing to <code>ggplot2</code>.</p>
<p>Use <code>hrbrthemes</code> for a nicer layout:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;hrbrthemes&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggsci&quot;</span>)
<span class="kw">import_roboto_condensed</span>()

g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> mass, <span class="dt">color =</span> color)) +<span class="st"> </span>hrbrthemes::<span class="kw">theme_ipsum_rc</span>() +<span class="st"> </span>
<span class="st">    </span>ggsci::<span class="kw">scale_color_rickandmorty</span>()
<span class="kw">print</span>(g)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="colors" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Colors</h3>
<p>Use <code>cowplot</code> for publication ready plots and <code>colorspace</code> in order to remove some hue and chroma. <code>Viridis</code> is a wonderful set of colors for continuous, sequential data. For discrete, qualitative data I mainly use <code>ggthemr</code> and the <code>fresh</code> colors. <code>ggsci</code> also has some wonderful color palettes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;colorspace&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;colorblindr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;viridis&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;scales&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;cowplot&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggthemr&quot;</span>)
<span class="kw">ggthemr</span>(<span class="st">&quot;fresh&quot;</span>)

p1 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_sequential</span>(<span class="st">&quot;viridis&quot;</span>, 
    <span class="dt">c1 =</span> <span class="dv">20</span>, <span class="dt">c2 =</span> <span class="dv">70</span>, <span class="dt">l1 =</span> <span class="dv">25</span>, <span class="dt">l2 =</span> <span class="dv">100</span>)
p2 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_sequential</span>(<span class="st">&quot;Blues&quot;</span>, 
    <span class="dt">c1 =</span> <span class="dv">20</span>, <span class="dt">c2 =</span> <span class="dv">70</span>, <span class="dt">l1 =</span> <span class="dv">25</span>, <span class="dt">l2 =</span> <span class="dv">100</span>)
p3 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_diverging</span>(<span class="dt">c1 =</span> <span class="dv">40</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Col =</span> ggthemr::<span class="kw">swatch</span>()[<span class="dv">1</span>:<span class="dv">10</span>], <span class="dt">X =</span> <span class="dv">1</span>, <span class="dt">Y =</span> <span class="kw">seq</span>(<span class="dv">10</span>))
p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y, <span class="dt">y =</span> X), <span class="dt">fill =</span> df$Col) +<span class="st"> </span><span class="kw">theme_void</span>()

cowplot::<span class="kw">plot_grid</span>(p1, p2, p3, p4, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Often you want to create an interactive plot, for instance when serving on a <code>shiny</code> instance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;plotly&quot;</span>)
plotly::<span class="kw">ggplotly</span>(g)</code></pre></div>
<div id="70861055b368" style="width:672px;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="70861055b368">{"x":{"data":[{"x":[15,6,2,28,24,37,33,18,32,46],"y":[25,24,39,35,30,36,39,21,30,39],"text":["height: 173<br />mass: 74<br />color: black","height: 160<br />mass: 68<br />color: black","height: 122<br />mass: unknown<br />color: black","height: 196<br />mass: 87<br />color: black","height: 188<br />mass: 80<br />color: black","height: 229<br />mass: 88<br />color: black","height: 213<br />mass: unknown<br />color: black","height: 178<br />mass: 57<br />color: black","height: 206<br />mass: 80<br />color: black","height: unknown<br />mass: unknown<br />color: black"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(250,253,124,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(250,253,124,1)"}},"hoveron":"points","name":"black","legendgroup":"black","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[14,18,8,24,19,36,19,16,4,27,12,21,22,28,21,12,9,10,38],"y":[27,6,26,33,39,4,3,29,39,37,39,39,18,39,39,20,18,39,7],"text":["height: 172<br />mass: 77<br />color: blue","height: 178<br />mass: 120<br />color: blue","height: 165<br />mass: 75<br />color: blue","height: 188<br />mass: 84<br />color: blue","height: 180<br />mass: unknown<br />color: blue","height: 228<br />mass: 112<br />color: blue","height: 180<br />mass: 110<br />color: blue","height: 175<br />mass: 79<br />color: blue","height: 150<br />mass: unknown<br />color: blue","height: 193<br />mass: 89<br />color: blue","height: 170<br />mass: unknown<br />color: blue","height: 183<br />mass: unknown<br />color: blue","height: 184<br />mass: 50<br />color: blue","height: 196<br />mass: unknown<br />color: blue","height: 183<br />mass: unknown<br />color: blue","height: 170<br />mass: 56.2<br />color: blue","height: 166<br />mass: 50<br />color: blue","height: 167<br />mass: unknown<br />color: blue","height: 234<br />mass: 136<br />color: blue"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(130,73,30,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(130,73,30,1)"}},"hoveron":"points","name":"blue","legendgroup":"blue","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[20],"y":[27],"text":"height: 182<br />mass: 77<br />color: blue-gray","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(36,50,95,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(36,50,95,1)"}},"hoveron":"points","name":"blue-gray","legendgroup":"blue-gray","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4,21,19,40,21,17,46,42,21,7,24,13,23,5,8,27,26,21,24,46,8],"y":[17,33,30,11,28,29,39,12,39,39,33,39,34,39,39,30,39,29,29,39,15],"text":["height: 150<br />mass: 49<br />color: brown","height: 183<br />mass: 84<br />color: brown","height: 180<br />mass: 80<br />color: brown","height: 66<br />mass: 17<br />color: brown","height: 183<br />mass: 78.2<br />color: brown","height: 177<br />mass: 79<br />color: brown","height: unknown<br />mass: unknown<br />color: brown","height: 88<br />mass: 20<br />color: brown","height: 183<br />mass: unknown<br />color: brown","height: 163<br />mass: unknown<br />color: brown","height: 188<br />mass: 84<br />color: brown","height: 171<br />mass: unknown<br />color: brown","height: 185<br />mass: 85<br />color: brown","height: 157<br />mass: unknown<br />color: brown","height: 165<br />mass: unknown<br />color: brown","height: 193<br />mass: 80<br />color: brown","height: 191<br />mass: unknown<br />color: brown","height: 183<br />mass: 79<br />color: brown","height: 188<br />mass: 79<br />color: brown","height: unknown<br />mass: unknown<br />color: brown","height: 165<br />mass: 45<br />color: brown"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(183,228,249,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(183,228,249,1)"}},"hoveron":"points","name":"brown","legendgroup":"brown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[46],"y":[39],"text":"height: unknown<br />mass: unknown<br />color: dark","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(251,100,103,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(251,100,103,1)"}},"hoveron":"points","name":"dark","legendgroup":"dark","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[26],"y":[39],"text":"height: 191<br />mass: unknown<br />color: gold","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(82,110,45,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(82,110,45,1)"}},"hoveron":"points","name":"gold","legendgroup":"gold","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34],"y":[10],"text":"height: 216<br />mass: 159<br />color: green, yellow","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,98,215,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,98,215,1)"}},"hoveron":"points","name":"green, yellow","legendgroup":"green, yellow","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12,18,46],"y":[27,19,39],"text":["height: 170<br />mass: 77<br />color: hazel","height: 178<br />mass: 55<br />color: hazel","height: unknown<br />mass: unknown<br />color: hazel"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(232,146,66,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(232,146,66,1)"}},"hoveron":"points","name":"hazel","legendgroup":"hazel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16,19,28,35,32,1,7,24],"y":[1,32,23,31,39,14,22,39],"text":["height: 175<br />mass: 1,358<br />color: orange","height: 180<br />mass: 83<br />color: orange","height: 196<br />mass: 66<br />color: orange","height: 224<br />mass: 82<br />color: orange","height: 206<br />mass: unknown<br />color: orange","height: 112<br />mass: 40<br />color: orange","height: 163<br />mass: 65<br />color: orange","height: 188<br />mass: unknown<br />color: orange"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(250,228,139,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(250,228,139,1)"}},"hoveron":"points","name":"orange","legendgroup":"orange","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[19],"y":[39],"text":"height: 180<br />mass: unknown<br />color: pink","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(166,238,230,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(166,238,230,1)"}},"hoveron":"points","name":"pink","legendgroup":"pink","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[44,45,30,25,26],"y":[13,13,8,5,38],"text":["height: 96<br />mass: 32<br />color: red","height: 97<br />mass: 32<br />color: red","height: 200<br />mass: 140<br />color: red","height: 190<br />mass: 113<br />color: red","height: 191<br />mass: 90<br />color: red"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(145,124,93,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(145,124,93,1)"}},"hoveron":"points","name":"red","legendgroup":"red","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[44],"y":[39],"text":"height: 96<br />mass: unknown<br />color: red, blue","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(105,200,236,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(105,200,236,1)"}},"hoveron":"points","name":"red, blue","legendgroup":"red, blue","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[41,27,46],"y":[9,16,39],"text":["height: 79<br />mass: 15<br />color: unknown","height: 193<br />mass: 48<br />color: unknown","height: unknown<br />mass: unknown<br />color: unknown"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["transparent","transparent","transparent"],"opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":["transparent","transparent","transparent"]}},"hoveron":"points","name":"unknown","legendgroup":"unknown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18],"y":[16],"text":"height: 178<br />mass: 48<br />color: white","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"white","legendgroup":"white","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[10,31,12,3,16,43,29,39,21,11,29],"y":[26,7,26,39,30,15,31,39,30,19,2],"text":["height: 167<br />mass: 75<br />color: yellow","height: 202<br />mass: 136<br />color: yellow","height: 170<br />mass: 75<br />color: yellow","height: 137<br />mass: unknown<br />color: yellow","height: 175<br />mass: 80<br />color: yellow","height: 94<br />mass: 45<br />color: yellow","height: 198<br />mass: 82<br />color: yellow","height: 264<br />mass: unknown<br />color: yellow","height: 183<br />mass: 80<br />color: yellow","height: 168<br />mass: 55<br />color: yellow","height: 198<br />mass: 102<br />color: yellow"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent"],"opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":["transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent"]}},"hoveron":"points","name":"yellow","legendgroup":"yellow","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":62.4923204649232,"r":39.8505603985056,"b":77.5425487754255,"l":109.090909090909},"font":{"color":"rgba(0,0,0,1)","family":"Roboto Condensed","size":15.2760481527605},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,46.6],"ticktext":["112","122","137","150","157","160","163","165","166","167","168","170","171","172","173","175","177","178","180","182","183","184","185","188","190","191","193","196","198","200","202","206","213","216","224","228","229","234","264","66","79","88","94","96","97","unknown"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Roboto Condensed","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":"height","titlefont":{"color":"rgba(0,0,0,1)","family":"Roboto Condensed","size":11.9551681195517},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,39.6],"ticktext":["1,358","102","110","112","113","120","136","140","15","159","17","20","32","40","45","48","49","50","55","56.2","57","65","66","68","74","75","77","78.2","79","80","82","83","84","85","87","88","89","90","unknown"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Roboto Condensed","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":"mass","titlefont":{"color":"rgba(0,0,0,1)","family":"Roboto Condensed","size":11.9551681195517},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Roboto Condensed","size":12.2208385222084},"y":0.924540682414698},"annotations":[{"text":"color","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Roboto Condensed","size":15.2760481527605},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest"},"source":"A","attrs":{"7086678be0d4":{"x":{},"y":{},"colour":{},"type":"ggplotly"}},"cur_data":"7086678be0d4","visdat":{"7086678be0d4":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="other-packages-to-consider" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Other packages to consider</h3>
<p>Other useful packages for plotting, using colors, animations or working with images are:</p>
<ul>
<li><code>magick</code></li>
<li><code>imager</code></li>
<li><code>scales</code></li>
<li><code>tweenr</code> (and basically everything from <a href="https://github.com/thomasp85">Thomas Pederson</a>.)</li>
<li><code>ggraph</code> and <code>ggnetwork</code></li>
<li><code>gganimate</code></li>
<li><code>ggpubr</code></li>
</ul>
</div>
</div>
<div id="data.table" class="section level2">
<h2><span class="header-section-number">4.4</span> data.table</h2>
<p><code>data.table</code> is a fast implementation of R’s classical <code>data.frame</code>. I hardly ever use data frame any more, and if so only, because it seems to work nicer with <code>dplyr</code> and <code>tidyr</code>. However, using <code>dtplyr</code> this isn’t much of a problem, really.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;data.table&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dtplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;grid&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gridExtra&quot;</span>)
n &lt;-<span class="st"> </span><span class="dv">1000</span>
rn &lt;-<span class="st"> </span>stats::<span class="kw">rnorm</span>(n)
ltrs &lt;-<span class="st"> </span>base::<span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">5</span>], n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
dt &lt;-<span class="st"> </span>data.table::<span class="kw">data.table</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)
df &lt;-<span class="st"> </span>base::<span class="kw">data.frame</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)

dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)] %&gt;%<span class="st"> </span><span class="kw">tableGrob</span>(<span class="dt">rows =</span> <span class="ot">NULL</span>) %&gt;%<span class="st"> </span>grid.arrange</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="192" style="display: block; margin: auto;" /></p>
<p>In the end it depends what style you prefer. I usually go with <code>data.table</code> alone without needing the <code>dplyr/dtplyr</code> dependency. However, the latter is usually more readable. For large data, the fastest solution is probably preferable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt.only &lt;-<span class="st"> </span>function() dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)]
dt.dtplyr &lt;-<span class="st"> </span>function() dt %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)
df.dplyr &lt;-<span class="st"> </span>function() df %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)

microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">dt.only</span>(), <span class="kw">dt.dtplyr</span>(), <span class="kw">df.dplyr</span>())</code></pre></div>
<pre><code>Unit: milliseconds
        expr       min        lq      mean    median        uq       max
   dt.only()  1.783957  1.984442  2.322906  2.208109  2.398008  4.524121
 dt.dtplyr()  3.313494  3.660432  4.000528  3.852000  4.042150 10.027283
  df.dplyr() 14.524182 15.422114 16.775869 15.723450 16.906906 35.825118
 neval cld
   100 a  
   100  b 
   100   c</code></pre>
</div>
<div id="mlr-and-openml" class="section level2">
<h2><span class="header-section-number">4.5</span> mlR and openML</h2>
<p>CRAN offers dozens of packages related to machine and statistical learning, many of which doing the same. <code>mlR</code> wraps many of these into one big library. <code>mlR</code> integrates with <code>openML</code>, an open machine learning platform where people share code, data and algorithms. Here we show an example where we use a Gaussian process to predict the Kyphosis label from the <code>gam</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlr)
task &lt;-<span class="st"> </span>mlr::<span class="kw">makeClassifTask</span>(<span class="dt">data =</span> kyphosis, <span class="dt">target =</span> <span class="st">&quot;Kyphosis&quot;</span>)
lrn &lt;-<span class="st"> </span>mlr::<span class="kw">makeLearner</span>(<span class="st">&quot;classif.gausspr&quot;</span>)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(kyphosis)
train.set &lt;-<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">size =</span> <span class="dv">2</span>/<span class="dv">3</span> *<span class="st"> </span>n)
test.set &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="dv">1</span>:n, train.set)

model &lt;-<span class="st"> </span>mlr::<span class="kw">train</span>(lrn, task, <span class="dt">subset =</span> train.set)</code></pre></div>
<pre><code>Using automatic sigma estimation (sigest) for RBF or laplace kernel </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span>stats::<span class="kw">predict</span>(model, <span class="dt">task =</span> task, <span class="dt">subset =</span> test.set)
<span class="kw">performance</span>(pred, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, acc))</code></pre></div>
<pre><code>     mmce       acc 
0.1851852 0.8148148 </code></pre>
</div>
<div id="object-oriented-programming" class="section level2">
<h2><span class="header-section-number">4.6</span> Object-oriented programming</h2>
<p>R has three different native ways for object-oriented programming and as far as I know one additional library. <code>S3</code>, <code>S4</code> and <code>RefClasses</code> (<code>R5</code>) come with the standard library, while <code>R6</code> can be installed from CRAN. I actually never use R5, because it feels incredibly bulky and slow, so we will not cover it here.</p>
<div id="s3" class="section level3">
<h3><span class="header-section-number">4.6.1</span> S3</h3>
<p>S3 methods dispatch on the first argument. If you come from other languages, such as <code>Java</code>, an S3 method is basically an overloaded function on the first argument. You can define an S3 function like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s3 &lt;-<span class="st"> </span>function(x, y, ...) <span class="kw">UseMethod</span>(<span class="st">&quot;s3&quot;</span>)

s3.matrix &lt;-<span class="st"> </span>function(x, y, ...) <span class="kw">apply</span>(x, <span class="dv">1</span>, sum)
s3.character &lt;-<span class="st"> </span>function(x, y, ...) <span class="kw">paste</span>(x, y)

<span class="kw">s3</span>(<span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">2</span>))</code></pre></div>
<pre><code>[1]  9 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">s3</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;reader&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;hello reader&quot;</code></pre>
<p>S3 classes are defines like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s3.list &lt;-<span class="st"> </span>function(x, y, ...) {
    l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)
    base::<span class="kw">class</span>(l) &lt;-<span class="st"> &quot;my.s3&quot;</span>
    
    l
}
<span class="kw">s3</span>(<span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">1</span>), <span class="dt">y =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>$x
$x$x
[1] 1


$y
[1] 2

attr(,&quot;class&quot;)
[1] &quot;my.s3&quot;</code></pre>
<p>The main issue here is of course that the user can easily overwrite a class and that method dispatching on one argument usually is not enough. However, often S3 functions are all you need.</p>
</div>
<div id="s4" class="section level3">
<h3><span class="header-section-number">4.6.2</span> S4</h3>
<p>Bioconductor seems to prefer S4 over S3, so if you want to submit your package, you could for instance define interfaces using S4 and the rest using S3 or w/o OO entirely. In that way the user of your package only sees the exported interface (the S4 method) and upon calling would receive an S4 object. The rest of the implementation would be hidden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">methods::<span class="kw">setClass</span>(<span class="st">&quot;normallist&quot;</span>, <span class="dt">representation =</span> <span class="kw">list</span>(<span class="dt">.el =</span> <span class="st">&quot;list&quot;</span>), <span class="dt">prototype =</span> <span class="kw">prototype</span>(<span class="dt">.el =</span> <span class="kw">list</span>()))

methods::<span class="kw">setGeneric</span>(<span class="st">&quot;put&quot;</span>, function(obj, x) base::<span class="kw">standardGeneric</span>(<span class="st">&quot;insert&quot;</span>))</code></pre></div>
<pre><code>[1] &quot;put&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">methods::<span class="kw">setMethod</span>(<span class="st">&quot;put&quot;</span>, <span class="dt">signature =</span> <span class="kw">signature</span>(<span class="dt">obj =</span> <span class="st">&quot;normallist&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;vector&quot;</span>), 
    function(obj, x) obj@.el &lt;-<span class="st"> </span><span class="kw">as.list</span>(x))</code></pre></div>
<pre><code>[1] &quot;put&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>methods::<span class="kw">new</span>(<span class="st">&quot;normallist&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">put</span>(d, <span class="kw">seq</span>(<span class="dv">3</span>))
d</code></pre></div>
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] 3</code></pre>
</div>
</div>
<div id="shiny" class="section level2">
<h2><span class="header-section-number">4.7</span> Shiny</h2>
<p>Next to Rmarkdown, setting up a Shiny instance for reporting is a nice way to present data with interactive plots. Setting up shiny is fairly easy. You need to create a <code>server.R</code> file and <code>ui.R</code> file, e.g. like this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> R/server.R
  <span class="kw">cat</span> R/ui.R</code></pre></div>
<pre><code>library(shiny)
library(shinyjs)
library(ggplot2)
library(ggsci)
library(hrbrthemes)

shinyServer(function(input, output)
{

    output$scatterplot &lt;- renderPlot({
        ggplot(iris, aes(x=Sepal.Width, y=Sepal.Length, colour=Species)) +
            geom_point(aes(colour=Species)) +
            geom_smooth(alpha=.1) +
            hrbrthemes::theme_ipsum_rc() +
            ggsci::scale_colour_rickandmorty() +
            labs(title=&quot;Iris scatter plot&quot;,
                 subtitle=&quot;Visualizing sepal width vs. sepal length for several species in a schwifty theme.&quot;)
  })
})
library(shiny)
library(shinyjs)
library(plotly)

shinyUI(
    fluidPage(
        useShinyjs(),
        fluidRow(
            column(
                width = 6,offset=2,
                h3(&quot;Scatterplot&quot;),
                HTML(&quot;&lt;h5&gt;&lt;i&gt;Created using ggplot2, hrbrthemes and ggsci on the iris data.&lt;/i&gt;&lt;/h5&gt;&quot;),
                plotOutput(&quot;scatterplot&quot;, width=800)
            )
        )

    )
)</code></pre>
<p>You can publish your server on <a href="http://www.shinyapps.io/">shinyapps.io</a> so that it is accessible by everyone.</p>
</div>
<div id="pryr" class="section level2">
<h2><span class="header-section-number">4.8</span> Pryr</h2>
<p>In some cases it is interesting to have a look at the implementation of specific functions, get their sizes in byte or get the current memory consumption. It is especially useful to keep track of the addresses your objects point to. When I was new to R I found it confusing when a reference is dropped and when a new copy of an object is created.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;pryr&quot;</span>)
pryr::<span class="kw">inspect</span>(<span class="kw">list</span>())</code></pre></div>
<pre><code>&lt;VECSXP 0x7f97a6594978&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">inspect</span>(<span class="kw">vector</span>())</code></pre></div>
<pre><code>&lt;LGLSXP 0x7f97a65d8178&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">object_size</span>(<span class="kw">numeric</span>())</code></pre></div>
<pre><code>40 B</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">object_size</span>(<span class="kw">numeric</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>48 B</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>stats::<span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span>x
pryr::<span class="kw">address</span>(x)</code></pre></div>
<pre><code>[1] &quot;0x7f97a9492358&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">address</span>(y)</code></pre></div>
<pre><code>[1] &quot;0x7f97a9492358&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
pryr::<span class="kw">address</span>(y)</code></pre></div>
<pre><code>[1] &quot;0x7f97a9e507f0&quot;</code></pre>
</div>
<div id="datastructures" class="section level2">
<h2><span class="header-section-number">4.9</span> datastructures</h2>
<p>If you have a background in computer science you may wonder, that R does not have support for advanced data structures such as Fibonacci heaps or hashmaps. <code>datastructures</code> tries to solve this. It uses Rcpp modules to export Boost data structures to R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;datastructures&quot;</span>)
q &lt;-<span class="st"> </span>datastructures::<span class="kw">fibonacci_heap</span>(<span class="st">&quot;integer&quot;</span>, <span class="st">&quot;numeric&quot;</span>)
q[<span class="dv">1</span>:<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rnorm</span>(<span class="dv">3</span>), <span class="dv">2</span>, <span class="kw">rnorm</span>(<span class="dv">4</span>))
datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`1`
[1]  0.6618629 -0.5875861  1.3652257</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`2`
[1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`3`
[1] -1.4973796 -0.8891795 -0.1231594 -1.7567824</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>NULL</code></pre>
</div>
<div id="other" class="section level2">
<h2><span class="header-section-number">4.10</span> Other</h2>
<p>There are many other great tools I did not specifically mention due to the fact that they are more situational. Some of these are:</p>
<ul>
<li>dplyr,</li>
<li>tidyr,</li>
<li>IRKernel,</li>
<li>minqa and nloptr,</li>
<li>glmnet, lme4 and netReg.</li>
</ul>
</div>
</div>

<footer style="margin-top: 5%">
    <p style="font-size: 0.75em;">&copy; 2017 Simon Dirmeier (<a href="mailto:simon.dirmeier@web.de">simon.dirmeier@web.de</a>)
    </p>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
