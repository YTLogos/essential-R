<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Essential R</title>
  <meta name="description" content="Essential R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Essential R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="dirmeier/essential-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Essential R" />
  
  
  

<meta name="author" content="Simon Dirmeier">


<meta name="date" content="2018-10-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="programming-paradigma-in-r.html">
<link rel="next" href="good-practices.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-2.2.1/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.3/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.3/js/ggvis.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="_css/theme.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">essential-R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>1</b> R package development</a><ul>
<li class="chapter" data-level="1.1" data-path="r-package-development.html"><a href="r-package-development.html#creating-r-packages"><i class="fa fa-check"></i><b>1.1</b> Creating R packages</a></li>
<li class="chapter" data-level="1.2" data-path="r-package-development.html"><a href="r-package-development.html#writing-r-packages"><i class="fa fa-check"></i><b>1.2</b> Writing R packages</a></li>
<li class="chapter" data-level="1.3" data-path="r-package-development.html"><a href="r-package-development.html#testing-code"><i class="fa fa-check"></i><b>1.3</b> Testing code</a></li>
<li class="chapter" data-level="1.4" data-path="r-package-development.html"><a href="r-package-development.html#documenting-code"><i class="fa fa-check"></i><b>1.4</b> Documenting code</a></li>
<li class="chapter" data-level="1.5" data-path="r-package-development.html"><a href="r-package-development.html#checking-code"><i class="fa fa-check"></i><b>1.5</b> Checking code</a></li>
<li class="chapter" data-level="1.6" data-path="r-package-development.html"><a href="r-package-development.html#static-code-analysis"><i class="fa fa-check"></i><b>1.6</b> Static code analysis</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-package-development.html"><a href="r-package-development.html#running-examples"><i class="fa fa-check"></i><b>1.6.1</b> Running examples</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-package-development.html"><a href="r-package-development.html#code-coverage"><i class="fa fa-check"></i><b>1.7</b> Code coverage</a></li>
<li class="chapter" data-level="1.8" data-path="r-package-development.html"><a href="r-package-development.html#profiling-and-benchmarking"><i class="fa fa-check"></i><b>1.8</b> Profiling and benchmarking</a></li>
<li class="chapter" data-level="1.9" data-path="r-package-development.html"><a href="r-package-development.html#creating-a-landing-page"><i class="fa fa-check"></i><b>1.9</b> Creating a landing page</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html"><i class="fa fa-check"></i><b>2</b> Programming paradigma in R</a><ul>
<li class="chapter" data-level="2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#functional-programming"><i class="fa fa-check"></i><b>2.1</b> Functional programming</a></li>
<li class="chapter" data-level="2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#object-oriented-programming"><i class="fa fa-check"></i><b>2.2</b> Object-oriented programming</a><ul>
<li class="chapter" data-level="2.2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s3"><i class="fa fa-check"></i><b>2.2.1</b> S3</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s4"><i class="fa fa-check"></i><b>2.2.2</b> S4</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r5"><i class="fa fa-check"></i><b>2.2.3</b> R5</a></li>
<li class="chapter" data-level="2.2.4" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r6"><i class="fa fa-check"></i><b>2.2.4</b> R6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-libraries.html"><a href="r-libraries.html"><i class="fa fa-check"></i><b>3</b> R libraries</a><ul>
<li class="chapter" data-level="3.1" data-path="r-libraries.html"><a href="r-libraries.html#data-wrangling"><i class="fa fa-check"></i><b>3.1</b> Data wrangling</a></li>
<li class="chapter" data-level="3.2" data-path="r-libraries.html"><a href="r-libraries.html#extending-to-c-using-rcpp"><i class="fa fa-check"></i><b>3.2</b> Extending to C++ using Rcpp</a><ul>
<li class="chapter" data-level="3.2.1" data-path="r-libraries.html"><a href="r-libraries.html#rcpp-in-a-package"><i class="fa fa-check"></i><b>3.2.1</b> Rcpp in a package</a></li>
<li class="chapter" data-level="3.2.2" data-path="r-libraries.html"><a href="r-libraries.html#writing-c"><i class="fa fa-check"></i><b>3.2.2</b> Writing <code>C++</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-libraries.html"><a href="r-libraries.html#plotting"><i class="fa fa-check"></i><b>3.3</b> Plotting</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r-libraries.html"><a href="r-libraries.html#layout"><i class="fa fa-check"></i><b>3.3.1</b> Layout</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-libraries.html"><a href="r-libraries.html#publication-ready-plots"><i class="fa fa-check"></i><b>3.3.2</b> Publication ready plots</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-libraries.html"><a href="r-libraries.html#colors"><i class="fa fa-check"></i><b>3.3.3</b> Colors</a></li>
<li class="chapter" data-level="3.3.4" data-path="r-libraries.html"><a href="r-libraries.html#interactive-and-animated-plots"><i class="fa fa-check"></i><b>3.3.4</b> Interactive and animated plots</a></li>
<li class="chapter" data-level="3.3.5" data-path="r-libraries.html"><a href="r-libraries.html#graphs"><i class="fa fa-check"></i><b>3.3.5</b> Graphs</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-libraries.html"><a href="r-libraries.html#data.table"><i class="fa fa-check"></i><b>3.4</b> data.table</a></li>
<li class="chapter" data-level="3.5" data-path="r-libraries.html"><a href="r-libraries.html#mlr-and-openml"><i class="fa fa-check"></i><b>3.5</b> mlR and openML</a></li>
<li class="chapter" data-level="3.6" data-path="r-libraries.html"><a href="r-libraries.html#markdown-and-shiny"><i class="fa fa-check"></i><b>3.6</b> Markdown and Shiny</a><ul>
<li class="chapter" data-level="3.6.1" data-path="r-libraries.html"><a href="r-libraries.html#shiny"><i class="fa fa-check"></i><b>3.6.1</b> Shiny</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r-libraries.html"><a href="r-libraries.html#pryr"><i class="fa fa-check"></i><b>3.7</b> Pryr</a></li>
<li class="chapter" data-level="3.8" data-path="r-libraries.html"><a href="r-libraries.html#datastructures"><i class="fa fa-check"></i><b>3.8</b> datastructures</a></li>
<li class="chapter" data-level="3.9" data-path="r-libraries.html"><a href="r-libraries.html#workflow-management"><i class="fa fa-check"></i><b>3.9</b> Workflow management</a></li>
<li class="chapter" data-level="3.10" data-path="r-libraries.html"><a href="r-libraries.html#others"><i class="fa fa-check"></i><b>3.10</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>4</b> Good practices</a><ul>
<li class="chapter" data-level="4.1" data-path="good-practices.html"><a href="good-practices.html#continuous-integration"><i class="fa fa-check"></i><b>4.1</b> Continuous integration</a></li>
<li class="chapter" data-level="4.2" data-path="good-practices.html"><a href="good-practices.html#version-control"><i class="fa fa-check"></i><b>4.2</b> Version control</a></li>
<li class="chapter" data-level="4.3" data-path="good-practices.html"><a href="good-practices.html#docker"><i class="fa fa-check"></i><b>4.3</b> Docker</a></li>
<li class="chapter" data-level="4.4" data-path="good-practices.html"><a href="good-practices.html#code-style"><i class="fa fa-check"></i><b>4.4</b> Code style</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essential R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-libraries" class="section level1">
<h1><span class="header-section-number">3</span> R libraries</h1>
<p>Much of R’s popularity is due to its fantastic ecosystem. R users benefit heavily from CRAN and Bioconductor packages created by its community. For data analysis or statistics R is a good choice for various reasons:</p>
<ul>
<li>high-level,</li>
<li>easy to install packages,</li>
<li>can be extended to C++ without needing knowledge of linking or C++ build-systems,</li>
<li>probably the best plotting facility with ggplot, cowplot, hrbrthemes, ggsci and others,</li>
<li>Bioconductor, machine learning and statistics libraries,</li>
<li>small standard library.</li>
</ul>
<p>There are a few things, however, R is not so great at:</p>
<ul>
<li>in general slow,</li>
<li>not really suited for large projects,</li>
<li>poor object orientation,</li>
<li>inconsistent function names,</li>
<li>very limited threading capabilities.</li>
</ul>
<p>For stats, data analysis and writing reports I find R still superior to Python, partly due to <code>Rmarkdown</code>, <code>shiny</code>, <code>ggplot2</code> and <code>Rcpp</code>.</p>
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">3.1</span> Data wrangling</h2>
<p>Every analysis of data starts with preprocessing and parsing. For this I’ve found <code>dplyr</code> and <code>tidyr</code> tremendously useful. There are many more great tools in the tidyverse and Rstudio, such as <code>purrr</code> (explained later), <code>magrittr</code> or <code>tibble</code>, but these two simlify most of my work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">data</span>(iris)
<span class="kw">group_by</span>(iris, Species) %&gt;%<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Petal.Length =</span> <span class="kw">mean</span>(Petal.Length), <span class="dt">Sepal.Length =</span> <span class="kw">mean</span>(Sepal.Length)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">toupper</span>(Species))</code></pre></div>
<pre><code># A tibble: 3 x 3
  Species    Petal.Length Sepal.Length
  &lt;chr&gt;             &lt;dbl&gt;        &lt;dbl&gt;
1 SETOSA             1.46         5.01
2 VERSICOLOR         4.26         5.94
3 VIRGINICA          5.55         6.59</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tidyr::<span class="kw">gather</span>(iris, Col, Val, -Species) %&gt;%<span class="st"> </span>head</code></pre></div>
<pre><code>  Species          Col Val
1  setosa Sepal.Length 5.1
2  setosa Sepal.Length 4.9
3  setosa Sepal.Length 4.7
4  setosa Sepal.Length 4.6
5  setosa Sepal.Length 5.0
6  setosa Sepal.Length 5.4</code></pre>
</div>
<div id="extending-to-c-using-rcpp" class="section level2">
<h2><span class="header-section-number">3.2</span> Extending to C++ using Rcpp</h2>
<p>Using Rcpp (and RcppEigen, RcppArmadillo, Boost) you can easily your extend your code to C++. It not only nicely wraps the standard C API, but also let’s you use standard matrix libraries such as Eigen and Armadillo or Boost.</p>
<p>If you have a project that’s not a package you can for instance create a function like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rcpp::<span class="kw">cppFunction</span>(<span class="st">&quot;double sum(std::vector&lt;double&gt;&amp; vec) {</span>
<span class="st">      double sum = .0;</span>
<span class="st">      for (std::vector&lt;double&gt;::size_type i = 0; i &lt; vec.size(); ++i)</span>
<span class="st">          sum += vec[i];</span>
<span class="st">      return sum;</span>
<span class="st">  }&quot;</span>)

<span class="kw">sum</span>(<span class="kw">as.numeric</span>(<span class="kw">seq</span>(<span class="dv">10</span>)))</code></pre></div>
<pre><code>[1] 55</code></pre>
<p>Let’s have a look at an Eigen example with sourceCpp:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> ./_src/square.cpp</code></pre></div>
<pre><code>// [[Rcpp::depends(RcppEigen)]]
#include &lt;RcppEigen.h&gt;

// [[Rcpp::export]]
Eigen::MatrixXd square(Eigen::MatrixXd&amp; m)
{
    return m.transpose() * m;
}</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;RcppEigen&quot;</span>)
Rcpp::<span class="kw">sourceCpp</span>(<span class="st">&quot;./_src/square.cpp&quot;</span>)
<span class="kw">square</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dv">2</span>))</code></pre></div>
<pre><code>           [,1]       [,2]       [,3]       [,4]       [,5]
[1,]  1.1809514  1.3039481 -0.6709814  0.4204252 -1.9400934
[2,]  1.3039481  1.5176923 -0.4074778  0.2579352 -2.3642668
[3,] -0.6709814 -0.4074778  1.8073350 -1.1212513  0.1521923
[4,]  0.4204252  0.2579352 -1.1212513  0.6956308 -0.1028183
[5,] -1.9400934 -2.3642668  0.1521923 -0.1028183  3.8202198</code></pre>
<p>Even for small matrices, the speed up is already substantial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span> *<span class="st"> </span><span class="dv">100</span>), <span class="dv">100</span>)
microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">square</span>(m), <span class="kw">t</span>(m) %*%<span class="st"> </span>m)</code></pre></div>
<pre><code>Unit: microseconds
       expr     min       lq     mean    median        uq       max neval
  square(m) 204.942 315.3105  727.458  440.8635  751.2425  4609.457   100
 t(m) %*% m 694.202 883.4880 1846.186 1327.7880 1869.5325 15569.187   100
 cld
  a 
   b</code></pre>
<div id="rcpp-in-a-package" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Rcpp in a package</h3>
<p>Usually, you would want to put your source code into a <code>cpp</code> file in the <code>src</code> folder. Then you can call C++ from an R function, for instance as described below.</p>
<ol style="list-style-type: decimal">
<li>Define a C++ source file and put it in <code>src</code>, like this:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c">  <span class="ot">#include &lt;Rcpp.h&gt;</span>
  <span class="co">// [[Rcpp::export]]</span>
  Rcpp::List dostuff()
  {
    <span class="co">// some computations</span>

    <span class="kw">return</span> Rcpp::List::create(
      Rcpp::Named(<span class="st">&quot;a&quot;</span>) = ...
    );
  }</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Add this to your <code>DESCRIPTION</code>:</li>
</ol>
<pre><code>Imports: Rcpp
LinkingTo: Rcpp</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Add a comment <code>#' @useDynLib pkg, .registration = TRUE</code> to the documentation of any function, better yet to the package doc.</p></li>
<li><p>Call <code>devtools::document()</code></p></li>
<li><p>Call <code>Rcpp::compileAttributes(&quot;./pkg&quot;)</code></p></li>
</ol>
<p>This should let you access the C++ function from your package. For more details check out the main <a href="http://www.rcpp.org/">documentation</a> or some of my packages, like <a href="https://github.com/dirmeier/netReg">netReg</a> or <a href="https://github.com/dirmeier/datastructures">datastructures</a>. The latter also has an example how to use modules and Boost.</p>
</div>
<div id="writing-c" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Writing <code>C++</code></h3>
<p>Here are some tools that help you develop your code:</p>
<ul>
<li>gdb and lldb for debugging,</li>
<li>valgrind and gprof to check for memory leaks and for profiling,</li>
<li>Intel’s Parallel Studio XE (&lt;3) which is a toolbox for vectorization, debugging, memory checks, etc. If you can get hold of it, get it. It is magnificent.</li>
<li>Boost for unit tests, data structures and basically everything you ever need,</li>
<li>cppcheck for static code analysis,</li>
<li>doxygen for code documentation.</li>
</ul>
<p>Many C++ libraries, like Dlib, Eigen or tensorflow have an R interface, so before implementing functionality yourself check out if there is already an implementation for it.</p>
<p>At this point it also makes sense to have a look at various C++ books such as</p>
<ul>
<li>Scott Meyers: Effective Modern C++,</li>
<li>Scott Meyers: Effective C++,</li>
<li>Ben Klemens: 21. century C,</li>
<li>Kurt Guntheroth: Optimized C++,</li>
<li>Nicolai Josuttis: C++17 - the complete guide,</li>
<li>David Vandevoorde: C++ Templates - the compete guide.</li>
</ul>
<p>For fast numerical code OpenMP and advanced vector and streaming SIMD extensions (AVX/SSE) is often the way to go. Writing good code using AVX is however not very simple and knowledge of memory alignment is required. However, starting from version 4 (?), OpenMP easily allows vectorization using <code>#pragma simd</code>.</p>
<p><strong>Note: the last lines in this section are heavily subjective and only state the author’s opinion.</strong> <em>More and more garbage code is forced onto the scientific community, mostly related to academic hubris and lack of knowledge about how to </em>program* (we don’t mean how to <em>accomplish a task using a programming language</em>, but to embrace a language and its philosophy at its very core). If you aim to publish your code, make sure it follows <em>contemporary</em> good practices, standards and guidelines and that it is consistent, for instance by following people’s code who are part of the community for ages. At this point we want to emphasize that the author doesn’t claim to know C++, but rather that he is annoyed by this very trend.*</p>
<p>C++ is a large, complex language. Chances that you mess up, introduce bugs and memory leaks are high, unless you have some experience. In academia in mostly results in bad, un-maintainable code. If your argument is <em>but it is faster than R</em>, at least have a look at Fortran, Julia or Python (and <code>numpy</code>). If you still prefer hacking in C++ try to stick to some guidelines:</p>
<ul>
<li>don’t include C headers in your C++ projects .. just don’t. C and C++ are <strong>two</strong> languages. There is for need for <code>FILE*</code> or <code>malloc</code>.</li>
<li>modern C++ rarely needs pointers. Use <code>std::vector</code> or <code>std::unique_ptr</code>. No need to manually release pointers is an advantage of itself.</li>
<li>BOOST has (probably) everything you will ever need. Don’t reinvent the wheel and learn to include libraries in your project.</li>
<li>Learn how to use Cmake, Meson or autotools. You should <strong>never</strong> need to directly invoke a compiler or write a hard-coded Makefile.</li>
<li>Only because you have a PhD or M. Sc. in CS does not make you a prolific programmer. It requires staying up to date, <strong>reading other people’s code</strong> and embracing of new ideas and the very philosophy of the language and its community.</li>
<li>Print warnings. They are usually there for a reason.</li>
<li>Start a toy project or contribute to OSS projects.</li>
</ul>
</div>
</div>
<div id="plotting" class="section level2">
<h2><span class="header-section-number">3.3</span> Plotting</h2>
<p>One of the most significant reasons to use R is probably its plotting capabilities and people contributing to ggplot2 and the community’s effort of adding package that integrate with it. Some nice packages for plotting are the following:</p>
<ul>
<li><code>hrbrthemes</code></li>
<li><code>ggthemes</code></li>
<li><code>cowplot</code></li>
<li><code>ggpubr</code></li>
<li><code>ggthemr</code></li>
<li><code>ggsci</code></li>
<li><code>viridis</code> and <code>viridisLite</code></li>
<li><code>colorspace</code> and <code>colorblindr</code></li>
<li><code>highcharter</code></li>
<li><code>patchwork</code></li>
<li><code>animation</code></li>
<li><code>plotly</code></li>
<li><code>lattice</code></li>
<li><code>magick</code></li>
<li><code>imager</code></li>
<li><code>scales</code></li>
<li><code>tweenr</code></li>
<li><code>ggraph</code>, <code>ggnet</code> and <code>ggnetwork</code></li>
<li><code>gganimate</code> and <code>animattion</code></li>
</ul>
<div id="layout" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Layout</h3>
<p>Use <code>hrbrthemes</code> for a nicer layout:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;hrbrthemes&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggsci&quot;</span>)
<span class="kw">import_roboto_condensed</span>()

g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> mass, <span class="dt">color =</span> color)) +<span class="st"> </span>hrbrthemes::<span class="kw">theme_ipsum_rc</span>() +<span class="st"> </span>
<span class="st">    </span>ggsci::<span class="kw">scale_color_rickandmorty</span>()
<span class="kw">print</span>(g)</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Recently I started changing to simpler layouts and themes, for instance as described on <a href="http://motioninsocial.com/tufte/"> Tufte in R</a>. <code>ggthemes</code> offers some nice options to do so. For instance, if you are feeling jealous that you cannot draft some Excel plots, cause you are working with R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggthemes&quot;</span>)

g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> mass), <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) +<span class="st"> </span>ggthemes::<span class="kw">theme_excel</span>()
<span class="kw">print</span>(g)</code></pre></div>
<p><img src="essential-R_files/figure-html/blub-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="publication-ready-plots" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Publication ready plots</h3>
<p><code>cowplot</code> and <code>ggpubr</code> are great for greating publication ready plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, disp)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span>ggthemes::<span class="kw">theme_tufte</span>()
p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, disp)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span>ggthemes::<span class="kw">theme_gdocs</span>()

cowplot::<span class="kw">plot_grid</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Nice&quot;</span>, <span class="st">&quot;Meh&quot;</span>))</code></pre></div>
<p><img src="essential-R_files/figure-html/cow-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If these two are still not enough, I usually go with <code>patchwork</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(patchwork)
g +<span class="st"> </span>(p1 +<span class="st"> </span>p2) +<span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="essential-R_files/figure-html/patch-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="colors" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Colors</h3>
<p>I use <code>colorspace</code> and <code>colorblindr</code> in order to remove some hue and chroma. <code>viridis</code> is a wonderful set of colors for continuous, sequential data. For discrete, qualitative data I mainly use <code>ggthemr</code> and the <code>fresh</code> colors. <code>ggsci</code> also has some wonderful color palettes. <code>scales</code> lets you have a look at a color palette easily.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;colorspace&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;colorblindr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;viridis&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggthemr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;scales&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;cowplot&quot;</span>)
ggthemr::<span class="kw">ggthemr</span>(<span class="st">&quot;fresh&quot;</span>, <span class="st">&quot;scientific&quot;</span>, <span class="dt">spacing =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;inner&quot;</span>)

p1 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_sequential</span>(<span class="st">&quot;viridis&quot;</span>, 
    <span class="dt">c1 =</span> <span class="dv">20</span>, <span class="dt">c2 =</span> <span class="dv">70</span>, <span class="dt">l1 =</span> <span class="dv">25</span>, <span class="dt">l2 =</span> <span class="dv">100</span>)
p2 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_sequential</span>(<span class="st">&quot;Blues&quot;</span>, 
    <span class="dt">c1 =</span> <span class="dv">20</span>, <span class="dt">c2 =</span> <span class="dv">70</span>, <span class="dt">l1 =</span> <span class="dv">25</span>, <span class="dt">l2 =</span> <span class="dv">100</span>)
p3 &lt;-<span class="st"> </span>colorblindr::<span class="kw">gg_color_gradient</span>() +<span class="st"> </span>colorspace::<span class="kw">scale_fill_continuous_diverging</span>(<span class="dt">c1 =</span> <span class="dv">40</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Col =</span> ggthemr::<span class="kw">swatch</span>()[<span class="dv">1</span>:<span class="dv">10</span>], <span class="dt">X =</span> <span class="dv">1</span>, <span class="dt">Y =</span> <span class="kw">seq</span>(<span class="dv">10</span>))
p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y, <span class="dt">y =</span> X), <span class="dt">fill =</span> df$Col) +<span class="st"> </span><span class="kw">theme_void</span>()

cowplot::<span class="kw">plot_grid</span>(p1, p2, p3, p4, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>)</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Another great tool is <code>swatches</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(swatches)
omega_nebula &lt;-<span class="st"> </span><span class="kw">read_ase</span>(<span class="kw">system.file</span>(<span class="st">&quot;palettes&quot;</span>, <span class="st">&quot;omega_nebula.ase&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;swatches&quot;</span>))
<span class="kw">show_palette</span>(omega_nebula)</code></pre></div>
<p><img src="essential-R_files/figure-html/swatch-1.png" width="672" /></p>
</div>
<div id="interactive-and-animated-plots" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Interactive and animated plots</h3>
<p>Often you want to create an interactive plot, for instance when serving on a <code>shiny</code> instance. One way to do that is using plotly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;plotly&quot;</span>)
q &lt;-<span class="st"> </span><span class="kw">qplot</span>(<span class="dt">data =</span> iris, <span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">color =</span> Species) +<span class="st"> </span>
<span class="st">    </span>ggthemes::<span class="kw">theme_tufte</span>()
plotly::<span class="kw">ggplotly</span>(q)</code></pre></div>
<div id="183ee6094ab5" style="width:672px;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="183ee6094ab5">{"x":{"data":[{"x":[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5],"y":[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3],"text":["~Sepal.Length: 5.1<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 4.9<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 4.7<br />~Sepal.Width: 3.2<br />~Species: setosa","~Sepal.Length: 4.6<br />~Sepal.Width: 3.1<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.6<br />~Species: setosa","~Sepal.Length: 5.4<br />~Sepal.Width: 3.9<br />~Species: setosa","~Sepal.Length: 4.6<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 4.4<br />~Sepal.Width: 2.9<br />~Species: setosa","~Sepal.Length: 4.9<br />~Sepal.Width: 3.1<br />~Species: setosa","~Sepal.Length: 5.4<br />~Sepal.Width: 3.7<br />~Species: setosa","~Sepal.Length: 4.8<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 4.8<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 4.3<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 5.8<br />~Sepal.Width: 4.0<br />~Species: setosa","~Sepal.Length: 5.7<br />~Sepal.Width: 4.4<br />~Species: setosa","~Sepal.Length: 5.4<br />~Sepal.Width: 3.9<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 5.7<br />~Sepal.Width: 3.8<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.8<br />~Species: setosa","~Sepal.Length: 5.4<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.7<br />~Species: setosa","~Sepal.Length: 4.6<br />~Sepal.Width: 3.6<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.3<br />~Species: setosa","~Sepal.Length: 4.8<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.2<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 5.2<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 4.7<br />~Sepal.Width: 3.2<br />~Species: setosa","~Sepal.Length: 4.8<br />~Sepal.Width: 3.1<br />~Species: setosa","~Sepal.Length: 5.4<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.2<br />~Sepal.Width: 4.1<br />~Species: setosa","~Sepal.Length: 5.5<br />~Sepal.Width: 4.2<br />~Species: setosa","~Sepal.Length: 4.9<br />~Sepal.Width: 3.1<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.2<br />~Species: setosa","~Sepal.Length: 5.5<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 4.9<br />~Sepal.Width: 3.6<br />~Species: setosa","~Sepal.Length: 4.4<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.4<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 4.5<br />~Sepal.Width: 2.3<br />~Species: setosa","~Sepal.Length: 4.4<br />~Sepal.Width: 3.2<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.5<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.8<br />~Species: setosa","~Sepal.Length: 4.8<br />~Sepal.Width: 3.0<br />~Species: setosa","~Sepal.Length: 5.1<br />~Sepal.Width: 3.8<br />~Species: setosa","~Sepal.Length: 4.6<br />~Sepal.Width: 3.2<br />~Species: setosa","~Sepal.Length: 5.3<br />~Sepal.Width: 3.7<br />~Species: setosa","~Sepal.Length: 5.0<br />~Sepal.Width: 3.3<br />~Species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(101,173,194,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(101,173,194,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7],"y":[3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8],"text":["~Sepal.Length: 7.0<br />~Sepal.Width: 3.2<br />~Species: versicolor","~Sepal.Length: 6.4<br />~Sepal.Width: 3.2<br />~Species: versicolor","~Sepal.Length: 6.9<br />~Sepal.Width: 3.1<br />~Species: versicolor","~Sepal.Length: 5.5<br />~Sepal.Width: 2.3<br />~Species: versicolor","~Sepal.Length: 6.5<br />~Sepal.Width: 2.8<br />~Species: versicolor","~Sepal.Length: 5.7<br />~Sepal.Width: 2.8<br />~Species: versicolor","~Sepal.Length: 6.3<br />~Sepal.Width: 3.3<br />~Species: versicolor","~Sepal.Length: 4.9<br />~Sepal.Width: 2.4<br />~Species: versicolor","~Sepal.Length: 6.6<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 5.2<br />~Sepal.Width: 2.7<br />~Species: versicolor","~Sepal.Length: 5.0<br />~Sepal.Width: 2.0<br />~Species: versicolor","~Sepal.Length: 5.9<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 6.0<br />~Sepal.Width: 2.2<br />~Species: versicolor","~Sepal.Length: 6.1<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 5.6<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 6.7<br />~Sepal.Width: 3.1<br />~Species: versicolor","~Sepal.Length: 5.6<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 5.8<br />~Sepal.Width: 2.7<br />~Species: versicolor","~Sepal.Length: 6.2<br />~Sepal.Width: 2.2<br />~Species: versicolor","~Sepal.Length: 5.6<br />~Sepal.Width: 2.5<br />~Species: versicolor","~Sepal.Length: 5.9<br />~Sepal.Width: 3.2<br />~Species: versicolor","~Sepal.Length: 6.1<br />~Sepal.Width: 2.8<br />~Species: versicolor","~Sepal.Length: 6.3<br />~Sepal.Width: 2.5<br />~Species: versicolor","~Sepal.Length: 6.1<br />~Sepal.Width: 2.8<br />~Species: versicolor","~Sepal.Length: 6.4<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 6.6<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 6.8<br />~Sepal.Width: 2.8<br />~Species: versicolor","~Sepal.Length: 6.7<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 6.0<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 5.7<br />~Sepal.Width: 2.6<br />~Species: versicolor","~Sepal.Length: 5.5<br />~Sepal.Width: 2.4<br />~Species: versicolor","~Sepal.Length: 5.5<br />~Sepal.Width: 2.4<br />~Species: versicolor","~Sepal.Length: 5.8<br />~Sepal.Width: 2.7<br />~Species: versicolor","~Sepal.Length: 6.0<br />~Sepal.Width: 2.7<br />~Species: versicolor","~Sepal.Length: 5.4<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 6.0<br />~Sepal.Width: 3.4<br />~Species: versicolor","~Sepal.Length: 6.7<br />~Sepal.Width: 3.1<br />~Species: versicolor","~Sepal.Length: 6.3<br />~Sepal.Width: 2.3<br />~Species: versicolor","~Sepal.Length: 5.6<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 5.5<br />~Sepal.Width: 2.5<br />~Species: versicolor","~Sepal.Length: 5.5<br />~Sepal.Width: 2.6<br />~Species: versicolor","~Sepal.Length: 6.1<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 5.8<br />~Sepal.Width: 2.6<br />~Species: versicolor","~Sepal.Length: 5.0<br />~Sepal.Width: 2.3<br />~Species: versicolor","~Sepal.Length: 5.6<br />~Sepal.Width: 2.7<br />~Species: versicolor","~Sepal.Length: 5.7<br />~Sepal.Width: 3.0<br />~Species: versicolor","~Sepal.Length: 5.7<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 6.2<br />~Sepal.Width: 2.9<br />~Species: versicolor","~Sepal.Length: 5.1<br />~Sepal.Width: 2.5<br />~Species: versicolor","~Sepal.Length: 5.7<br />~Sepal.Width: 2.8<br />~Species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(35,59,67,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(35,59,67,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"y":[3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"text":["~Sepal.Length: 6.3<br />~Sepal.Width: 3.3<br />~Species: virginica","~Sepal.Length: 5.8<br />~Sepal.Width: 2.7<br />~Species: virginica","~Sepal.Length: 7.1<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.3<br />~Sepal.Width: 2.9<br />~Species: virginica","~Sepal.Length: 6.5<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 7.6<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 4.9<br />~Sepal.Width: 2.5<br />~Species: virginica","~Sepal.Length: 7.3<br />~Sepal.Width: 2.9<br />~Species: virginica","~Sepal.Length: 6.7<br />~Sepal.Width: 2.5<br />~Species: virginica","~Sepal.Length: 7.2<br />~Sepal.Width: 3.6<br />~Species: virginica","~Sepal.Length: 6.5<br />~Sepal.Width: 3.2<br />~Species: virginica","~Sepal.Length: 6.4<br />~Sepal.Width: 2.7<br />~Species: virginica","~Sepal.Length: 6.8<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 5.7<br />~Sepal.Width: 2.5<br />~Species: virginica","~Sepal.Length: 5.8<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 6.4<br />~Sepal.Width: 3.2<br />~Species: virginica","~Sepal.Length: 6.5<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 7.7<br />~Sepal.Width: 3.8<br />~Species: virginica","~Sepal.Length: 7.7<br />~Sepal.Width: 2.6<br />~Species: virginica","~Sepal.Length: 6.0<br />~Sepal.Width: 2.2<br />~Species: virginica","~Sepal.Length: 6.9<br />~Sepal.Width: 3.2<br />~Species: virginica","~Sepal.Length: 5.6<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 7.7<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 6.3<br />~Sepal.Width: 2.7<br />~Species: virginica","~Sepal.Length: 6.7<br />~Sepal.Width: 3.3<br />~Species: virginica","~Sepal.Length: 7.2<br />~Sepal.Width: 3.2<br />~Species: virginica","~Sepal.Length: 6.2<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 6.1<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.4<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 7.2<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 7.4<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 7.9<br />~Sepal.Width: 3.8<br />~Species: virginica","~Sepal.Length: 6.4<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 6.3<br />~Sepal.Width: 2.8<br />~Species: virginica","~Sepal.Length: 6.1<br />~Sepal.Width: 2.6<br />~Species: virginica","~Sepal.Length: 7.7<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.3<br />~Sepal.Width: 3.4<br />~Species: virginica","~Sepal.Length: 6.4<br />~Sepal.Width: 3.1<br />~Species: virginica","~Sepal.Length: 6.0<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.9<br />~Sepal.Width: 3.1<br />~Species: virginica","~Sepal.Length: 6.7<br />~Sepal.Width: 3.1<br />~Species: virginica","~Sepal.Length: 6.9<br />~Sepal.Width: 3.1<br />~Species: virginica","~Sepal.Length: 5.8<br />~Sepal.Width: 2.7<br />~Species: virginica","~Sepal.Length: 6.8<br />~Sepal.Width: 3.2<br />~Species: virginica","~Sepal.Length: 6.7<br />~Sepal.Width: 3.3<br />~Species: virginica","~Sepal.Length: 6.7<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.3<br />~Sepal.Width: 2.5<br />~Species: virginica","~Sepal.Length: 6.5<br />~Sepal.Width: 3.0<br />~Species: virginica","~Sepal.Length: 6.2<br />~Sepal.Width: 3.4<br />~Species: virginica","~Sepal.Length: 5.9<br />~Sepal.Width: 3.0<br />~Species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(232,70,70,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(232,70,70,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.5235920852359,"r":7.30593607305936,"b":38.4779299847793,"l":43.1050228310502},"font":{"color":"rgba(0,0,0,1)","family":"serif","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[4.12,8.08],"tickmode":"array","ticktext":["5","6","7","8"],"tickvals":[5,6,7,8],"categoryorder":"array","categoryarray":["5","6","7","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"serif","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Sepal.Length","titlefont":{"color":"rgba(0,0,0,1)","family":"serif","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[1.88,4.52],"tickmode":"array","ticktext":["2.0","2.5","3.0","3.5","4.0","4.5"],"tickvals":[2,2.5,3,3.5,4,4.5],"categoryorder":"array","categoryarray":["2.0","2.5","3.0","3.5","4.0","4.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"serif","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Sepal.Width","titlefont":{"color":"rgba(0,0,0,1)","family":"serif","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"serif","size":11.689497716895},"y":0.927821522309711},"annotations":[{"text":"Species","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"serif","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"183ee72298d81":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"183ee72298d81","visdat":{"183ee72298d81":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>Recently I also stumbled upon <code>highcharter</code> and <code>ggvis</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;highcharter&quot;</span>)
<span class="kw">hchart</span>(iris, <span class="st">&quot;scatter&quot;</span>, <span class="kw">hcaes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">group =</span> Species)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">hc_add_theme</span>(<span class="kw">hc_theme_tufte</span>())</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggvis&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)
mtcars %&gt;%<span class="st"> </span><span class="kw">ggvis</span>(~wt, ~mpg, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(size, <span class="kw">input_slider</span>(<span class="dv">10</span>, <span class="dv">100</span>)), <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(opacity, 
    <span class="kw">input_slider</span>(<span class="dv">0</span>, <span class="dv">1</span>))) %&gt;%<span class="st"> </span><span class="kw">layer_points</span>()</code></pre></div>
<div id="plot_id869596086-container" class="ggvis-output-container">
<div id="plot_id869596086" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id869596086_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id869596086" data-renderer="svg">SVG</a>
 | 
<a id="plot_id869596086_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id869596086" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id869596086_download" class="ggvis-download" data-plot-id="plot_id869596086">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id869596086_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "reactive_572583004": "number",
          "reactive_451577039": "number",
          "wt": "number",
          "mpg": "number"
        }
      },
      "values": "\"reactive_572583004\",\"reactive_451577039\",\"wt\",\"mpg\"\n55,0.5,2.62,21\n55,0.5,2.875,21\n55,0.5,2.32,22.8\n55,0.5,3.215,21.4\n55,0.5,3.44,18.7\n55,0.5,3.46,18.1\n55,0.5,3.57,14.3\n55,0.5,3.19,24.4\n55,0.5,3.15,22.8\n55,0.5,3.44,19.2\n55,0.5,3.44,17.8\n55,0.5,4.07,16.4\n55,0.5,3.73,17.3\n55,0.5,3.78,15.2\n55,0.5,5.25,10.4\n55,0.5,5.424,10.4\n55,0.5,5.345,14.7\n55,0.5,2.2,32.4\n55,0.5,1.615,30.4\n55,0.5,1.835,33.9\n55,0.5,2.465,21.5\n55,0.5,3.52,15.5\n55,0.5,3.435,15.2\n55,0.5,3.84,13.3\n55,0.5,3.845,19.2\n55,0.5,1.935,27.3\n55,0.5,2.14,26\n55,0.5,1.513,30.4\n55,0.5,3.17,15.8\n55,0.5,2.77,19.7\n55,0.5,3.57,15\n55,0.5,2.78,21.4"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.31745\n5.61955"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n9.225\n35.075"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "field": "data.reactive_572583004"
          },
          "opacity": {
            "field": "data.reactive_451577039"
          },
          "x": {
            "scale": "x",
            "field": "data.wt"
          },
          "y": {
            "scale": "y",
            "field": "data.mpg"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 576
  },
  "handlers": null
};
ggvis.getPlot("plot_id869596086").parseSpec(plot_id869596086_spec);
</script>
<p>With <code>gganimate</code> you can directly create GIFs from you plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;gganimate&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gapminder&quot;</span>)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapminder, <span class="kw">aes</span>(gdpPercap, lifeExp, <span class="dt">size =</span> pop, <span class="dt">frame =</span> year)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> year), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(~continent, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +<span class="st"> </span>ggthemes::<span class="kw">theme_tufte</span>()
<span class="kw">gganimate</span>(g)</code></pre></div>
<div class="figure">
<img src="https://rawgit.com/dirmeier/essential-R/master/fig/gganimate.gif" />

</div>
</div>
<div id="graphs" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Graphs</h3>
<p>There are many wonderful graph and network libraries around. I primarily use <code>ggnetwork</code>/<code>ggnet2</code>, <code>igraph</code>, <code>ggraph</code> and <code>DiagrammeR</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DiagrammeR)
<span class="kw">create_graph</span>() %&gt;%<span class="st"> </span><span class="kw">add_node</span>(<span class="dt">label =</span> <span class="kw">expression</span>(Z), <span class="dt">node_aes =</span> <span class="kw">node_aes</span>(<span class="dt">penwidth =</span> <span class="dv">2</span>, 
    <span class="dt">fontname =</span> <span class="st">&quot;Arial Narrow&quot;</span>, <span class="dt">fontcolor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fillcolor =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">add_node</span>(<span class="dt">label =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">node_aes =</span> <span class="kw">node_aes</span>(<span class="dt">penwidth =</span> <span class="dv">2</span>, <span class="dt">fontname =</span> <span class="st">&quot;Arial Narrow&quot;</span>, 
        <span class="dt">fontcolor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fillcolor =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) %&gt;%<span class="st"> </span><span class="kw">add_edge</span>(<span class="dt">from =</span> <span class="dv">1</span>, 
    <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">edge_aes =</span> <span class="kw">edge_aes</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) %&gt;%<span class="st"> </span><span class="kw">render_graph</span>(<span class="dt">layout =</span> <span class="st">&quot;tree&quot;</span>)</code></pre></div>
<div id="htmlwidget-24a53c1d0c39cff1da75" style="width:672px;height:192px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-24a53c1d0c39cff1da75">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"Z\", penwidth = \"2\", color = \"black\", fontname = \"Arial Narrow\", fontcolor = \"black\", fillcolor = \"#FFFFFF\", pos = \"0,2!\"] \n  \"2\" [label = \"X\", penwidth = \"2\", color = \"black\", fontname = \"Arial Narrow\", fontcolor = \"black\", fillcolor = \"#C0C0C0\", pos = \"0,1!\"] \n\"1\"->\"2\" [color = \"black\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="data.table" class="section level2">
<h2><span class="header-section-number">3.4</span> data.table</h2>
<p><code>data.table</code> is a fast implementation of R’s classical <code>data.frame</code>. I hardly ever use data frame any more, and if so only, because it seems to work nicer with <code>dplyr</code> and <code>tidyr</code>. However, by using <code>dtplyr</code> this isn’t much of a problem, really.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;data.table&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dtplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;grid&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gridExtra&quot;</span>)

n &lt;-<span class="st"> </span><span class="dv">1000</span>
rn &lt;-<span class="st"> </span>stats::<span class="kw">rnorm</span>(n)
ltrs &lt;-<span class="st"> </span>base::<span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">5</span>], n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
dt &lt;-<span class="st"> </span>data.table::<span class="kw">data.table</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)
df &lt;-<span class="st"> </span>base::<span class="kw">data.frame</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)

dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)] %&gt;%<span class="st"> </span><span class="kw">tableGrob</span>(<span class="dt">rows =</span> <span class="ot">NULL</span>) %&gt;%<span class="st"> </span>grid.arrange</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-32-1.png" width="192" style="display: block; margin: auto;" /></p>
<p>In the end it depends what style you prefer. I usually go with <code>data.table</code> alone without needing the <code>dplyr/dtplyr</code> dependency. However, the latter is usually more readable. For large data, the fastest solution is probably preferable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt.only &lt;-<span class="st"> </span>function() dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)]
dt.dtplyr &lt;-<span class="st"> </span>function() dt %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)
df.dplyr &lt;-<span class="st"> </span>function() df %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)

microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">dt.only</span>(), <span class="kw">dt.dtplyr</span>(), <span class="kw">df.dplyr</span>())</code></pre></div>
<pre><code>Unit: milliseconds
        expr      min       lq     mean   median       uq       max neval
   dt.only() 1.627221 1.775081 2.059207 1.906559 2.112410  5.201621   100
 dt.dtplyr() 2.421354 2.683622 3.172868 2.813725 3.061799 14.350918   100
  df.dplyr() 1.525751 1.715917 1.986308 1.832446 1.995918  5.039091   100
 cld
  a 
   b
  a </code></pre>
</div>
<div id="mlr-and-openml" class="section level2">
<h2><span class="header-section-number">3.5</span> mlR and openML</h2>
<p>CRAN offers dozens of packages related to machine and statistical learning, many of which doing the same. <code>mlR</code> wraps many of these into one big library. <code>mlR</code> integrates with <code>openML</code>, an open machine learning platform where people share code, data and algorithms. Here we show an example where we use a Gaussian process to predict the Kyphosis label from the <code>gam</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlr)
task &lt;-<span class="st"> </span>mlr::<span class="kw">makeClassifTask</span>(<span class="dt">data =</span> kyphosis, <span class="dt">target =</span> <span class="st">&quot;Kyphosis&quot;</span>)
lrn &lt;-<span class="st"> </span>mlr::<span class="kw">makeLearner</span>(<span class="st">&quot;classif.gausspr&quot;</span>)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(kyphosis)
train.set &lt;-<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">size =</span> <span class="dv">2</span>/<span class="dv">3</span> *<span class="st"> </span>n)
test.set &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="dv">1</span>:n, train.set)

model &lt;-<span class="st"> </span>mlr::<span class="kw">train</span>(lrn, task, <span class="dt">subset =</span> train.set)</code></pre></div>
<pre><code>Using automatic sigma estimation (sigest) for RBF or laplace kernel </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span>stats::<span class="kw">predict</span>(model, <span class="dt">task =</span> task, <span class="dt">subset =</span> test.set)
<span class="kw">performance</span>(pred, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, acc))</code></pre></div>
<pre><code>     mmce       acc 
0.2592593 0.7407407 </code></pre>
</div>
<div id="markdown-and-shiny" class="section level2">
<h2><span class="header-section-number">3.6</span> Markdown and Shiny</h2>
<p><code>Rmarkdown</code> is a great way for documentation, reporting and working reproducibly. Rstudio provides tons of different output formats like web sites (like this one), Tufte style documents, blogs and others. If you want to present your work interactively you can do so by building a web page using <code>shiny</code>. For presentations that use R code I use either <a href="https://github.com/yihui/xaringan">xaringan</a>, <a href="http://slidify.org/">Slidify</a> or <a href="https://rmarkdown.rstudio.com/revealjs_presentation_format.html">reveal.js</a>.</p>
<p>Find all the output formats by Rstudio <a href="https://rmarkdown.rstudio.com/lesson-9.html">here</a>.</p>
<div id="shiny" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Shiny</h3>
<p>Setting up a Shiny instance for reporting is a great way to present data using interactive plots. Setting up shiny is fairly easy. You need to create a <code>server.R</code> file and <code>ui.R</code> file, e.g. like this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> R/ui.R</code></pre></div>
<pre><code>library(shiny)
library(shinyjs)
library(plotly)

shinyUI(
    fluidPage(
        useShinyjs(),
        fluidRow(
            column(
                width = 6,offset=2,
                h3(&quot;Scatterplot&quot;),
                HTML(&quot;&lt;h5&gt;&lt;i&gt;Created using ggplot2, hrbrthemes and ggsci on the iris data.&lt;/i&gt;&lt;/h5&gt;&quot;),
                plotOutput(&quot;scatterplot&quot;, width=800)
            )
        )

    )
)</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="kw">cat</span> R/ui.R</code></pre></div>
<pre><code>library(shiny)
library(shinyjs)
library(plotly)

shinyUI(
    fluidPage(
        useShinyjs(),
        fluidRow(
            column(
                width = 6,offset=2,
                h3(&quot;Scatterplot&quot;),
                HTML(&quot;&lt;h5&gt;&lt;i&gt;Created using ggplot2, hrbrthemes and ggsci on the iris data.&lt;/i&gt;&lt;/h5&gt;&quot;),
                plotOutput(&quot;scatterplot&quot;, width=800)
            )
        )

    )
)</code></pre>
<p>You can publish your server on <a href="http://www.shinyapps.io/">shinyapps.io</a> so that it is accessible by everyone.</p>
</div>
</div>
<div id="pryr" class="section level2">
<h2><span class="header-section-number">3.7</span> Pryr</h2>
<p>In some cases it is interesting to have a look at the implementation of specific functions, get their sizes in byte or get the current memory consumption. It is especially useful to keep track of the addresses your objects point to. When I was new to R I found it confusing when a reference is dropped and when a new copy of an object is created.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;pryr&quot;</span>)
pryr::<span class="kw">inspect</span>(<span class="kw">list</span>())</code></pre></div>
<pre><code>&lt;VECSXP 0x7fcce395cba8&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">inspect</span>(<span class="kw">vector</span>())</code></pre></div>
<pre><code>&lt;LGLSXP 0x7fcce407dd90&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">object_size</span>(<span class="kw">numeric</span>())</code></pre></div>
<pre><code>48 B</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">object_size</span>(<span class="kw">numeric</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>56 B</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>stats::<span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span>x
pryr::<span class="kw">address</span>(x)</code></pre></div>
<pre><code>[1] &quot;0x7fccc8393648&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pryr::<span class="kw">address</span>(y)</code></pre></div>
<pre><code>[1] &quot;0x7fccc8393648&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
pryr::<span class="kw">address</span>(y)</code></pre></div>
<pre><code>[1] &quot;0x7fccc838a4b8&quot;</code></pre>
</div>
<div id="datastructures" class="section level2">
<h2><span class="header-section-number">3.8</span> datastructures</h2>
<p>If you have a background in computer science you may wonder, that R does not have support for advanced data structures such as Fibonacci heaps or hashmaps. <code>datastructures</code> tries to solve this. It uses Rcpp modules to export Boost data structures to R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;datastructures&quot;</span>)
q &lt;-<span class="st"> </span>datastructures::<span class="kw">fibonacci_heap</span>(<span class="st">&quot;integer&quot;</span>)
q[<span class="dv">1</span>:<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rnorm</span>(<span class="dv">3</span>), <span class="dv">2</span>, <span class="kw">rnorm</span>(<span class="dv">4</span>))
datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`1`
[1] -0.5581804 -1.0901567 -1.0550364</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`2`
[1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`3`
[1] -0.190276198 -0.003941753 -1.434193519  0.868626929</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures::<span class="kw">pop</span>(q)</code></pre></div>
<pre><code>NULL</code></pre>
</div>
<div id="workflow-management" class="section level2">
<h2><span class="header-section-number">3.9</span> Workflow management</h2>
<p>I recently came across <a href="https://ropensci.github.io/drake/index.html"><code>drake</code></a> as a workflow manager. It allows you to run a project and easily update output files.</p>
<div align="center">
<p><img src="https://rawgit.com/dirmeier/essential-R/master/fig/drake.jpg" alt="oh no" width="500px"></p>
</div>
</div>
<div id="others" class="section level2">
<h2><span class="header-section-number">3.10</span> Others</h2>
<p>There are many other great tools I did not specifically mention due to the fact that they are probably more situational. Some of these are:</p>
<ul>
<li>rlang</li>
<li>argparse,</li>
<li>IRKernel,</li>
<li>CVXR, minqa and nloptr,</li>
<li>tensorflow and keras,</li>
<li>glmnet, lme4 and netReg.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="programming-paradigma-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="good-practices.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
