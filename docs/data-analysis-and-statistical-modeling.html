<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5 Data analysis and statistical modeling | Essential R</title>
  <meta name="description" content="5 Data analysis and statistical modeling | Essential R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5 Data analysis and statistical modeling | Essential R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="dirmeier/essential-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Data analysis and statistical modeling | Essential R" />
  
  
  

<meta name="author" content="Simon Dirmeier">


<meta name="date" content="2019-03-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="working-with-data.html">
<link rel="next" href="optimization.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-2.2.1/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.4/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.4/js/ggvis.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="theme.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">essential-R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="about.html"><a href="about.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>1</b> R package development</a><ul>
<li class="chapter" data-level="1.1" data-path="r-package-development.html"><a href="r-package-development.html#creating-r-packages"><i class="fa fa-check"></i><b>1.1</b> Creating R packages</a></li>
<li class="chapter" data-level="1.2" data-path="r-package-development.html"><a href="r-package-development.html#writing-r-packages"><i class="fa fa-check"></i><b>1.2</b> Writing R packages</a></li>
<li class="chapter" data-level="1.3" data-path="r-package-development.html"><a href="r-package-development.html#debugging"><i class="fa fa-check"></i><b>1.3</b> Debugging</a></li>
<li class="chapter" data-level="1.4" data-path="r-package-development.html"><a href="r-package-development.html#testing-code"><i class="fa fa-check"></i><b>1.4</b> Testing code</a></li>
<li class="chapter" data-level="1.5" data-path="r-package-development.html"><a href="r-package-development.html#documenting-code"><i class="fa fa-check"></i><b>1.5</b> Documenting code</a></li>
<li class="chapter" data-level="1.6" data-path="r-package-development.html"><a href="r-package-development.html#checking-code"><i class="fa fa-check"></i><b>1.6</b> Checking code</a></li>
<li class="chapter" data-level="1.7" data-path="r-package-development.html"><a href="r-package-development.html#static-code-analysis"><i class="fa fa-check"></i><b>1.7</b> Static code analysis</a><ul>
<li class="chapter" data-level="1.7.1" data-path="r-package-development.html"><a href="r-package-development.html#running-examples"><i class="fa fa-check"></i><b>1.7.1</b> Running examples</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="r-package-development.html"><a href="r-package-development.html#code-coverage"><i class="fa fa-check"></i><b>1.8</b> Code coverage</a></li>
<li class="chapter" data-level="1.9" data-path="r-package-development.html"><a href="r-package-development.html#profiling-and-benchmarking"><i class="fa fa-check"></i><b>1.9</b> Profiling and benchmarking</a></li>
<li class="chapter" data-level="1.10" data-path="r-package-development.html"><a href="r-package-development.html#creating-a-landing-page"><i class="fa fa-check"></i><b>1.10</b> Creating a landing page</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html"><i class="fa fa-check"></i><b>2</b> Programming paradigma in R</a><ul>
<li class="chapter" data-level="2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#functional-programming"><i class="fa fa-check"></i><b>2.1</b> Functional programming</a></li>
<li class="chapter" data-level="2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#object-oriented-programming"><i class="fa fa-check"></i><b>2.2</b> Object-oriented programming</a><ul>
<li class="chapter" data-level="2.2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s3"><i class="fa fa-check"></i><b>2.2.1</b> S3</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s4"><i class="fa fa-check"></i><b>2.2.2</b> S4</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r6"><i class="fa fa-check"></i><b>2.2.3</b> R6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-extensions.html"><a href="r-extensions.html"><i class="fa fa-check"></i><b>3</b> R extensions</a><ul>
<li class="chapter" data-level="3.1" data-path="r-extensions.html"><a href="r-extensions.html#c-and-rcpp"><i class="fa fa-check"></i><b>3.1</b> C++ and Rcpp</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-extensions.html"><a href="r-extensions.html#rcpp-in-a-package"><i class="fa fa-check"></i><b>3.1.1</b> Rcpp in a package</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-extensions.html"><a href="r-extensions.html#writing-c"><i class="fa fa-check"></i><b>3.1.2</b> Writing <code>C++</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-extensions.html"><a href="r-extensions.html#fortran"><i class="fa fa-check"></i><b>3.2</b> Fortran</a></li>
<li class="chapter" data-level="3.3" data-path="r-extensions.html"><a href="r-extensions.html#reticulate"><i class="fa fa-check"></i><b>3.3</b> Reticulate</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-data.html"><a href="working-with-data.html"><i class="fa fa-check"></i><b>4</b> Working with data</a><ul>
<li class="chapter" data-level="4.1" data-path="working-with-data.html"><a href="working-with-data.html#tidyverse"><i class="fa fa-check"></i><b>4.1</b> tidyverse</a></li>
<li class="chapter" data-level="4.2" data-path="working-with-data.html"><a href="working-with-data.html#data.table"><i class="fa fa-check"></i><b>4.2</b> data.table</a></li>
<li class="chapter" data-level="4.3" data-path="working-with-data.html"><a href="working-with-data.html#data-structures"><i class="fa fa-check"></i><b>4.3</b> Data structures</a></li>
<li class="chapter" data-level="4.4" data-path="working-with-data.html"><a href="working-with-data.html#databases"><i class="fa fa-check"></i><b>4.4</b> Databases</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html"><i class="fa fa-check"></i><b>5</b> Data analysis and statistical modeling</a><ul>
<li class="chapter" data-level="5.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#stan"><i class="fa fa-check"></i><b>5.1</b> Stan</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#rstanarm"><i class="fa fa-check"></i><b>5.1.1</b> Rstanarm</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#brms"><i class="fa fa-check"></i><b>5.1.2</b> brms</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#bayesplot"><i class="fa fa-check"></i><b>5.1.3</b> bayesplot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#greta"><i class="fa fa-check"></i><b>5.2</b> greta</a></li>
<li class="chapter" data-level="5.3" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#mcmc"><i class="fa fa-check"></i><b>5.3</b> MCMC</a></li>
<li class="chapter" data-level="5.4" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#mlr-and-openml"><i class="fa fa-check"></i><b>5.4</b> mlR and openML</a></li>
<li class="chapter" data-level="5.5" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#tensorflow"><i class="fa fa-check"></i><b>5.5</b> Tensorflow</a></li>
<li class="chapter" data-level="5.6" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#keras"><i class="fa fa-check"></i><b>5.6</b> Keras</a></li>
<li class="chapter" data-level="5.7" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#statistical-learning"><i class="fa fa-check"></i><b>5.7</b> Statistical learning</a></li>
<li class="chapter" data-level="5.8" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#big-data-analytics"><i class="fa fa-check"></i><b>5.8</b> Big data analytics</a></li>
<li class="chapter" data-level="5.9" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#others"><i class="fa fa-check"></i><b>5.9</b> Others</a><ul>
<li class="chapter" data-level="5.9.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#modelr"><i class="fa fa-check"></i><b>5.9.1</b> modelr</a></li>
<li class="chapter" data-level="5.9.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#kernlab"><i class="fa fa-check"></i><b>5.9.2</b> kernlab</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>6</b> Optimization</a><ul>
<li class="chapter" data-level="6.1" data-path="optimization.html"><a href="optimization.html#convex-optimization"><i class="fa fa-check"></i><b>6.1</b> Convex optimization</a></li>
<li class="chapter" data-level="6.2" data-path="optimization.html"><a href="optimization.html#non-linear-optimizaton"><i class="fa fa-check"></i><b>6.2</b> Non-linear optimizaton</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html"><i class="fa fa-check"></i><b>7</b> Plotting, reporting and visualizing</a><ul>
<li class="chapter" data-level="7.1" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#layout"><i class="fa fa-check"></i><b>7.1</b> Layout</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#publication-ready-plots"><i class="fa fa-check"></i><b>7.2</b> Publication ready plots</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#colors"><i class="fa fa-check"></i><b>7.3</b> Colors</a></li>
<li class="chapter" data-level="7.4" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#interactive-and-animated-plots"><i class="fa fa-check"></i><b>7.4</b> Interactive and animated plots</a></li>
<li class="chapter" data-level="7.5" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#graphs"><i class="fa fa-check"></i><b>7.5</b> Graphs</a></li>
<li class="chapter" data-level="7.6" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#rmarkdown"><i class="fa fa-check"></i><b>7.6</b> RMarkdown</a></li>
<li class="chapter" data-level="7.7" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#shiny"><i class="fa fa-check"></i><b>7.7</b> Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#others-1"><i class="fa fa-check"></i><b>7.8</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>8</b> Miscellaneous</a><ul>
<li class="chapter" data-level="8.1" data-path="miscellaneous.html"><a href="miscellaneous.html#workflow-management"><i class="fa fa-check"></i><b>8.1</b> Workflow management</a></li>
<li class="chapter" data-level="8.2" data-path="miscellaneous.html"><a href="miscellaneous.html#pry-back-the-covers-of-r"><i class="fa fa-check"></i><b>8.2</b> Pry back the covers of R</a></li>
<li class="chapter" data-level="8.3" data-path="miscellaneous.html"><a href="miscellaneous.html#tidy-evaluation"><i class="fa fa-check"></i><b>8.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="8.4" data-path="miscellaneous.html"><a href="miscellaneous.html#compile"><i class="fa fa-check"></i><b>8.4</b> Compile</a></li>
<li class="chapter" data-level="8.5" data-path="miscellaneous.html"><a href="miscellaneous.html#others-2"><i class="fa fa-check"></i><b>8.5</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>9</b> Good practices</a><ul>
<li class="chapter" data-level="9.1" data-path="good-practices.html"><a href="good-practices.html#continuous-integration"><i class="fa fa-check"></i><b>9.1</b> Continuous integration</a></li>
<li class="chapter" data-level="9.2" data-path="good-practices.html"><a href="good-practices.html#version-control"><i class="fa fa-check"></i><b>9.2</b> Version control</a></li>
<li class="chapter" data-level="9.3" data-path="good-practices.html"><a href="good-practices.html#docker"><i class="fa fa-check"></i><b>9.3</b> Docker</a></li>
<li class="chapter" data-level="9.4" data-path="good-practices.html"><a href="good-practices.html#code-style"><i class="fa fa-check"></i><b>9.4</b> Code style</a></li>
<li class="chapter" data-level="9.5" data-path="good-practices.html"><a href="good-practices.html#debugging-c-from-r"><i class="fa fa-check"></i><b>9.5</b> Debugging C++ from R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essential R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis-and-statistical-modeling" class="section level1">
<h1><span class="header-section-number">5</span> Data analysis and statistical modeling</h1>
<p>The following few sections introduce packages I frequently use for data analysis, modelling and machine learning.</p>
<div id="stan" class="section level2">
<h2><span class="header-section-number">5.1</span> Stan</h2>
<p><code>Stan</code> is a great package for Bayesian modelling and inference. Compared to statistical packages that are fit to one model, such as <code>glmnet</code> or <code>lme4</code>, Stan allows to easily define custom Bayesian models for which posterior distributions are automatically inferred using HMC.</p>
<p>A simple liner regression model could look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstan)
<span class="kw">library</span>(lme4)

model &lt;-<span class="st"> &quot;</span>
<span class="st">data {</span>
<span class="st">  int&lt;lower=1&gt; n;</span>
<span class="st">  vector[n] x;</span>
<span class="st">  vector[n] y;</span>
<span class="st">}</span>

<span class="st">parameters {</span>
<span class="st">  real beta;</span>
<span class="st">  real&lt;lower=0&gt; sigma;</span>
<span class="st">  real alpha;</span>
<span class="st">}</span>

<span class="st">model {</span>
<span class="st">  beta ~ normal(0, 5);</span>
<span class="st">  sigma ~ cauchy(0, 5);</span>
<span class="st">  y ~ normal(alpha + x * beta, sigma);</span>
<span class="st">}</span>
<span class="st">&quot;</span>

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(sleepstudy)
x &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Days
y &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Reaction

fit &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">model_code =</span> model, <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">n =</span> n, <span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">warmup =</span> <span class="dv">100</span>, 
    <span class="dt">iter =</span> <span class="dv">1100</span>, <span class="dt">chains =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>
SAMPLING FOR MODEL &#39;920bbd45e873f3162b84171e9f3ae19f&#39; NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 2.6e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: There aren&#39;t enough warmup iterations to fit the
Chain 1:          three stages of adaptation as currently configured.
Chain 1:          Reducing each adaptation stage to 15%/75%/10% of
Chain 1:          the given number of warmup iterations:
Chain 1:            init_buffer = 15
Chain 1:            adapt_window = 75
Chain 1:            term_buffer = 10
Chain 1: 
Chain 1: Iteration:    1 / 1100 [  0%]  (Warmup)
Chain 1: Iteration:  101 / 1100 [  9%]  (Sampling)
Chain 1: Iteration:  210 / 1100 [ 19%]  (Sampling)
Chain 1: Iteration:  320 / 1100 [ 29%]  (Sampling)
Chain 1: Iteration:  430 / 1100 [ 39%]  (Sampling)
Chain 1: Iteration:  540 / 1100 [ 49%]  (Sampling)
Chain 1: Iteration:  650 / 1100 [ 59%]  (Sampling)
Chain 1: Iteration:  760 / 1100 [ 69%]  (Sampling)
Chain 1: Iteration:  870 / 1100 [ 79%]  (Sampling)
Chain 1: Iteration:  980 / 1100 [ 89%]  (Sampling)
Chain 1: Iteration: 1090 / 1100 [ 99%]  (Sampling)
Chain 1: Iteration: 1100 / 1100 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.058223 seconds (Warm-up)
Chain 1:                0.862701 seconds (Sampling)
Chain 1:                0.920924 seconds (Total)
Chain 1: </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit)</code></pre></div>
<pre><code>$summary
             mean    se_mean       sd        2.5%        25%         50%
beta     9.734508 0.10430790 1.307173    7.374048    8.84992    9.669498
sigma   47.782422 0.08083895 2.579821   43.259332   45.99257   47.563146
alpha  254.916993 0.64767282 7.282857  241.316674  250.44446  254.898783
lp__  -789.154520 0.12228032 1.526152 -792.932606 -789.76729 -788.763406
             75%      97.5%     n_eff     Rhat
beta    10.55408   12.47037  157.0477 1.024087
sigma   49.38598   53.29628 1018.4457 1.000171
alpha  260.02287  268.50520  126.4422 1.023848
lp__  -788.10495 -787.54819  155.7695 1.008462

$c_summary
, , chains = chain:1

         stats
parameter        mean       sd        2.5%        25%         50%
    beta     9.734508 1.307173    7.374048    8.84992    9.669498
    sigma   47.782422 2.579821   43.259332   45.99257   47.563146
    alpha  254.916993 7.282857  241.316674  250.44446  254.898783
    lp__  -789.154520 1.526152 -792.932606 -789.76729 -788.763406
         stats
parameter        75%      97.5%
    beta    10.55408   12.47037
    sigma   49.38598   53.29628
    alpha  260.02287  268.50520
    lp__  -788.10495 -787.54819</code></pre>
<div id="rstanarm" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Rstanarm</h3>
<p><code>rstanarm</code> is a package for applied Bayesian modelling that wraps around Stan for easier usage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstanarm)

fit.arm &lt;-<span class="st"> </span>rstanarm<span class="op">::</span><span class="kw">stan_glm</span>(Reaction <span class="op">~</span><span class="st"> </span>Days, sleepstudy, <span class="dt">chains =</span> <span class="dv">1</span>, <span class="dt">iter =</span> <span class="dv">1100</span>, 
    <span class="dt">warmup =</span> <span class="dv">100</span>, <span class="dt">family =</span> <span class="kw">gaussian</span>())</code></pre></div>
<pre><code>
SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 3.5e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.35 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: There aren&#39;t enough warmup iterations to fit the
Chain 1:          three stages of adaptation as currently configured.
Chain 1:          Reducing each adaptation stage to 15%/75%/10% of
Chain 1:          the given number of warmup iterations:
Chain 1:            init_buffer = 15
Chain 1:            adapt_window = 75
Chain 1:            term_buffer = 10
Chain 1: 
Chain 1: Iteration:    1 / 1100 [  0%]  (Warmup)
Chain 1: Iteration:  101 / 1100 [  9%]  (Sampling)
Chain 1: Iteration:  210 / 1100 [ 19%]  (Sampling)
Chain 1: Iteration:  320 / 1100 [ 29%]  (Sampling)
Chain 1: Iteration:  430 / 1100 [ 39%]  (Sampling)
Chain 1: Iteration:  540 / 1100 [ 49%]  (Sampling)
Chain 1: Iteration:  650 / 1100 [ 59%]  (Sampling)
Chain 1: Iteration:  760 / 1100 [ 69%]  (Sampling)
Chain 1: Iteration:  870 / 1100 [ 79%]  (Sampling)
Chain 1: Iteration:  980 / 1100 [ 89%]  (Sampling)
Chain 1: Iteration: 1090 / 1100 [ 99%]  (Sampling)
Chain 1: Iteration: 1100 / 1100 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.055629 seconds (Warm-up)
Chain 1:                0.510607 seconds (Sampling)
Chain 1:                0.566236 seconds (Total)
Chain 1: </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit.arm)</code></pre></div>
<pre><code>
Model Info:

 function:     stan_glm
 family:       gaussian [identity]
 formula:      Reaction ~ Days
 algorithm:    sampling
 priors:       see help(&#39;prior_summary&#39;)
 sample:       1000 (posterior sample size)
 observations: 180
 predictors:   2

Estimates:
                mean    sd      2.5%    25%     50%     75%     97.5%
(Intercept)     247.5    17.4   186.7   245.8   251.1   256.1   264.5
Days             10.4     1.4     7.6     9.6    10.5    11.3    13.2
sigma            49.9     8.6    42.8    46.2    48.0    49.9    78.6
mean_PPD        294.2    16.3   236.3   294.3   297.9   301.4   307.6
log-posterior  -967.0    22.7 -1052.3  -961.9  -960.8  -960.2  -959.6

Diagnostics:
              mcse Rhat n_eff
(Intercept)   4.2  1.1   17  
Days          0.1  1.0  723  
sigma         2.0  1.1   18  
mean_PPD      4.1  1.1   16  
log-posterior 5.9  1.1   15  

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
<div id="brms" class="section level3">
<h3><span class="header-section-number">5.1.2</span> brms</h3>
<p>For non-linear multi-level models <code>brms</code> is also a great option.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brms)

fit.multilevel &lt;-<span class="st"> </span><span class="kw">brm</span>(Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(Days <span class="op">|</span><span class="st"> </span>Subject), sleepstudy, <span class="dt">chains =</span> <span class="dv">1</span>, 
    <span class="dt">iter =</span> <span class="dv">1000</span>)</code></pre></div>
<pre><code>
SAMPLING FOR MODEL &#39;45335b867c1a5a0373bc06c1740c990e&#39; NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 5.1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2.43316 seconds (Warm-up)
Chain 1:                0.690034 seconds (Sampling)
Chain 1:                3.1232 seconds (Total)
Chain 1: </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit.multilevel)</code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ Days + (Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
Samples: 1 chains, each with iter = 1000; warmup = 500; thin = 1;
         total post-warmup samples = 500

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
sd(Intercept)          26.27      7.17    14.76    42.46        195 1.01
sd(Days)                6.43      1.42     4.13     9.52        126 1.00
cor(Intercept,Days)     0.08      0.29    -0.40     0.69        157 1.00

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
Intercept   251.95      7.40   239.74   266.92        266 1.00
Days         10.29      1.80     6.83    14.27        173 1.01

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
sigma    26.05      1.61    23.31    29.44        252 1.00

Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
is a crude measure of effective sample size, and Rhat is the potential 
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="bayesplot" class="section level3">
<h3><span class="header-section-number">5.1.3</span> bayesplot</h3>
<p>For plotting of Bayesian models inferred using the tools mentioned above, you probably want to use <code>bayesplot</code>. For instance, to compare posterior predictive intervals between the <code>rstanarm</code> linear model and the mixed model form <code>brms</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bayesplot)
<span class="kw">library</span>(cowplot)

p1 &lt;-<span class="st"> </span><span class="kw">ppc_intervals</span>(<span class="dt">y =</span> sleepstudy<span class="op">$</span>Reaction, <span class="dt">yrep =</span> <span class="kw">posterior_predict</span>(fit.arm)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear model&quot;</span>)
p2 &lt;-<span class="st"> </span><span class="kw">ppc_intervals</span>(<span class="dt">y =</span> sleepstudy<span class="op">$</span>Reaction, <span class="dt">yrep =</span> <span class="kw">posterior_predict</span>(fit.multilevel)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear mixed model&quot;</span>)

cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;h&quot;</span>)</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-39-1.png" width="960" /></p>
</div>
</div>
<div id="greta" class="section level2">
<h2><span class="header-section-number">5.2</span> greta</h2>
<p>Model definitions in Stan are arguable difficult in the beginning. As an alternative with <code>greta</code> is not only easier to compose models, but also often faster owing to the fact that it’s developed against tensorflow. Installation can be a bit tedious. For <code>greta</code> version <code>v.0.3</code> I would install tensorflow from the command line:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">conda</span> create -y -n r-tensorflow python=3.6
<span class="ex">conda</span> install tensorflow==1.10.0
<span class="ex">pip</span> install tensorflow-probability==0.30.0</code></pre></div>
<p>The same model we used for stan above, looks like this with greta:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(greta)
<span class="kw">library</span>(lme4)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(sleepstudy)
x &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Days
y &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Reaction

alpha &lt;-<span class="st"> </span><span class="kw">variable</span>()
beta &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>)
sigma &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">truncation =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">Inf</span>))

y &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">as_data</span>(y)
greta<span class="op">::</span><span class="kw">distribution</span>(y) &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">normal</span>(alpha <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>beta, sigma)

mod &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">model</span>(beta)
samples &lt;-<span class="st"> </span>greta<span class="op">::</span><span class="kw">mcmc</span>(mod, <span class="dt">n_samples =</span> <span class="dv">1000</span>, <span class="dt">warmup =</span> <span class="dv">100</span>, <span class="dt">chains =</span> <span class="dv">1</span>)</code></pre></div>
</div>
<div id="mcmc" class="section level2">
<h2><span class="header-section-number">5.3</span> MCMC</h2>
<p>There are a couple of packages on CRAN especially for Markov Chain Monte Carlo and Bayesian methods, some of which are mentioned below.</p>
<p><code>coda</code> is a package for analysis and diagnostics of MCMC chains. Mostly it takes arguments of class mcmc.list, so put your results into an object of it to be able to use <code>coda</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coda)

coda<span class="op">::</span><span class="kw">autocorr</span>(<span class="kw">As.mcmc.list</span>(fit))</code></pre></div>
<pre><code>[[1]]
, , beta

             beta       sigma       alpha        lp__
Lag 0  1.00000000 -0.09098018 -0.84679910  0.02323685
Lag 1  0.64649460 -0.05659510 -0.65854924 -0.02781911
Lag 5  0.19644228 -0.04945911 -0.24252697 -0.01379953
Lag 10 0.04554359 -0.03235870 -0.09980014  0.05001408
Lag 50 0.04263937  0.04612791 -0.04150179  0.01005839

, , sigma

              beta       sigma        alpha        lp__
Lag 0  -0.09098018  1.00000000  0.064407207 -0.16797674
Lag 1  -0.03181738 -0.09358071  0.042213847 -0.07805589
Lag 5  -0.02528513  0.02386571  0.023106123 -0.07835147
Lag 10  0.02170223 -0.01175329 -0.001123165 -0.04344650
Lag 50  0.04590280 -0.07346226 -0.029463816 -0.02172717

, , alpha

               beta       sigma        alpha        lp__
Lag 0  -0.846799096  0.06440721  1.000000000 -0.03091263
Lag 1  -0.644357194  0.05412907  0.758570269  0.01090853
Lag 5  -0.253959966  0.06250224  0.288738733  0.03339915
Lag 10 -0.001105280  0.01588829  0.072123141 -0.04399030
Lag 50  0.007197419 -0.05324803 -0.008289024 -0.01622294

, , lp__

               beta        sigma        alpha       lp__
Lag 0   0.023236851 -0.167976737 -0.030912631 1.00000000
Lag 1   0.003303205 -0.074906248  0.003060961 0.59562131
Lag 5  -0.013921540  0.021347125  0.022159315 0.22428970
Lag 10 -0.036899347  0.053249233  0.058175966 0.10776711
Lag 50 -0.052465458  0.009090258  0.050878108 0.04968255</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coda<span class="op">::</span><span class="kw">traceplot</span>(<span class="kw">As.mcmc.list</span>(fit))</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-42-1.png" width="672" /><img src="essential-R_files/figure-html/unnamed-chunk-42-2.png" width="672" /><img src="essential-R_files/figure-html/unnamed-chunk-42-3.png" width="672" /><img src="essential-R_files/figure-html/unnamed-chunk-42-4.png" width="672" /></p>
<p><code>MCMCpack</code> offer an alternative to rstanarm for applied Bayesian modelling. It also comes with a set of useful distributions used frequently in Bayesian modelling, such as the Dirichlet, inverse gamma, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MCMCpack)
invg &lt;-<span class="st"> </span>MCMCpack<span class="op">::</span><span class="kw">rinvgamma</span>(<span class="dv">1000</span>, <span class="dv">5</span>, <span class="dv">1</span>)
<span class="kw">hist</span>(invg, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>)</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>For plotting <code>mcmc.list</code> objects (from <code>coda</code>) <code>MCMCvis</code> is great:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MCMCvis<span class="op">::</span><span class="kw">MCMCplot</span>(<span class="kw">As.mcmc.list</span>(fit))</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="mlr-and-openml" class="section level2">
<h2><span class="header-section-number">5.4</span> mlR and openML</h2>
<p>CRAN offers dozens of packages related to machine and statistical learning, many of which doing the same. <code>mlR</code> wraps many of these into one big library. <code>mlR</code> integrates with <code>openML</code>, an open machine learning platform where people share code, data and algorithms. Here we show an example where we use a Gaussian process to predict the Kyphosis label from the <code>gam</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlr)
task &lt;-<span class="st"> </span>mlr<span class="op">::</span><span class="kw">makeClassifTask</span>(<span class="dt">data =</span> kyphosis, <span class="dt">target =</span> <span class="st">&quot;Kyphosis&quot;</span>)
lrn &lt;-<span class="st"> </span>mlr<span class="op">::</span><span class="kw">makeLearner</span>(<span class="st">&quot;classif.gausspr&quot;</span>)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(kyphosis)
train.set &lt;-<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n)
test.set &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="dv">1</span><span class="op">:</span>n, train.set)

model &lt;-<span class="st"> </span>mlr<span class="op">::</span><span class="kw">train</span>(lrn, task, <span class="dt">subset =</span> train.set)</code></pre></div>
<pre><code>Using automatic sigma estimation (sigest) for RBF or laplace kernel </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">predict</span>(model, <span class="dt">task =</span> task, <span class="dt">subset =</span> test.set)
<span class="kw">performance</span>(pred, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, acc))</code></pre></div>
<pre><code>     mmce       acc 
0.1111111 0.8888889 </code></pre>
</div>
<div id="tensorflow" class="section level2">
<h2><span class="header-section-number">5.5</span> Tensorflow</h2>
<p>Thanks to Rstudio, R users are able to use <code>tensorflow</code>, a library for high performance numerical computations (which for instance greta uses). For instance, a linear model could look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tensorflow)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(sleepstudy)
x &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Days
y &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>Reaction

<span class="co"># define model</span>
beta &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">Variable</span>(tf<span class="op">$</span><span class="kw">random_normal</span>(<span class="kw">shape</span>(1L), <span class="dv">0</span>, <span class="dv">10</span>))
alpha &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">Variable</span>(tf<span class="op">$</span><span class="kw">zeros</span>(<span class="kw">shape</span>(1L)))
y.hat &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x

<span class="co"># Minimize the mean squared errors.</span>
loss &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">reduce_mean</span>((y <span class="op">-</span><span class="st"> </span>y.hat)<span class="op">^</span><span class="dv">2</span>)
optimizer &lt;-<span class="st"> </span>tf<span class="op">$</span>train<span class="op">$</span><span class="kw">GradientDescentOptimizer</span>(<span class="fl">0.5</span>)
train &lt;-<span class="st"> </span>optimizer<span class="op">$</span><span class="kw">minimize</span>(loss)

<span class="co"># Launch the graph and initialize the variables.</span>
sess &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">Session</span>()
sess<span class="op">$</span><span class="kw">run</span>(tf<span class="op">$</span><span class="kw">global_variables_initializer</span>())

<span class="cf">for</span> (step <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {
    sess<span class="op">$</span><span class="kw">run</span>(train)
}</code></pre></div>
</div>
<div id="keras" class="section level2">
<h2><span class="header-section-number">5.6</span> Keras</h2>
<p><code>Keras</code> is an interface to popular numerical libraries such as tensorflow and theano for which model/network definitions are independent of the library on the backend. Our tensorflow model from above would look the following in keras:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(keras)

model &lt;-<span class="st"> </span><span class="kw">keras_model_sequential</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">1</span>, <span class="dt">activation =</span> <span class="st">&quot;linear&quot;</span>, 
    <span class="dt">input_shape =</span> <span class="dv">1</span>)
model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">compile</span>(<span class="dt">loss =</span> <span class="st">&quot;mse&quot;</span>, <span class="dt">optimizer =</span> <span class="kw">optimizer_sgd</span>(<span class="fl">0.5</span>), <span class="dt">metrics =</span> <span class="kw">list</span>(<span class="st">&quot;mean_absolute_error&quot;</span>))</code></pre></div>
</div>
<div id="statistical-learning" class="section level2">
<h2><span class="header-section-number">5.7</span> Statistical learning</h2>
<p>Some packages for regression:</p>
<ul>
<li><code>glmnet</code> for <span class="math inline">\(\ell_1\)</span>- and <span class="math inline">\(\ell_2\)</span>-penalized linear regression models,</li>
<li><code>lme4</code> for frequentist mixed models,</li>
<li><code>mgcv</code> for generalized additive models,</li>
<li><code>netReg</code> for graph regularized linear models,</li>
<li><code>xgboost</code> and <code>gbm</code> for boosting.</li>
<li><code>h20</code> for general machine learning algorithms,</li>
</ul>
<p>TODO some examples</p>
</div>
<div id="big-data-analytics" class="section level2">
<h2><span class="header-section-number">5.8</span> Big data analytics</h2>
<p>For Big data analytics I recommend Rstudio’s <code>sparklyr</code> since it nicelt itegrates with the other methods from the <code>tidyverse</code>. For instance, following an example from <a href="https://spark.rstudio.com/mlib/">Rstudio’s tutorials</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sparklyr)

sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>)
kmeans_model &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, iris, <span class="st">&quot;iris&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Petal_Width, 
    Petal_Length) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ml_kmeans</span>(<span class="dt">centers =</span> <span class="dv">3</span>)</code></pre></div>
</div>
<div id="others" class="section level2">
<h2><span class="header-section-number">5.9</span> Others</h2>
<p>Some other great packages for various data-related things:</p>
<div id="modelr" class="section level3">
<h3><span class="header-section-number">5.9.1</span> modelr</h3>
<p><code>modelr</code> defines multiple helper functions related to statistical modelling:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(modelr)

sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>modelr<span class="op">::</span><span class="kw">fit_with</span>(lm, modelr<span class="op">::</span><span class="kw">formulas</span>(<span class="op">~</span>Reaction, <span class="dt">no_intercept =</span> <span class="op">~</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>Days, <span class="dt">intercept =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days))</code></pre></div>
<pre><code>$no_intercept

Call:
.f(formula = Reaction ~ 0 + Days, data = data)

Coefficients:
 Days  
50.16  


$intercept

Call:
.f(formula = Reaction ~ 1 + Days, data = data)

Coefficients:
(Intercept)         Days  
     251.41        10.47  </code></pre>
</div>
<div id="kernlab" class="section level3">
<h3><span class="header-section-number">5.9.2</span> kernlab</h3>
<p>Use <code>kernlab</code> for tasks related to kernels, such as Gaussian process regression or merely computing a Gram-matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(kernlab)

x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>), <span class="dv">5</span>)
rbf &lt;-<span class="st"> </span>kernlab<span class="op">::</span><span class="kw">rbfdot</span>()
(K &lt;-<span class="st"> </span>kernlab<span class="op">::</span><span class="kw">kernelMatrix</span>(rbf, x))</code></pre></div>
<pre><code>An object of class &quot;kernelMatrix&quot;
             [,1]         [,2]         [,3]         [,4]         [,5]
[1,] 1.000000e+00 2.538052e-04 3.908063e-08 7.738091e-04 1.235612e-04
[2,] 2.538052e-04 1.000000e+00 2.785052e-10 1.300262e-07 8.685670e-02
[3,] 3.908063e-08 2.785052e-10 1.000000e+00 4.426158e-16 1.270126e-14
[4,] 7.738091e-04 1.300262e-07 4.426158e-16 1.000000e+00 2.306205e-07
[5,] 1.235612e-04 8.685670e-02 1.270126e-14 2.306205e-07 1.000000e+00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))
y &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)
gpr &lt;-<span class="st"> </span>kernlab<span class="op">::</span><span class="kw">gausspr</span>(x, y)</code></pre></div>
<pre><code>Using automatic sigma estimation (sigest) for RBF or laplace kernel </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, y, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>)
<span class="kw">lines</span>(x, <span class="kw">predict</span>(gpr, x), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
