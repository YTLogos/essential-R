<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Essential R</title>
  <meta name="description" content="Essential R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Essential R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="dirmeier/essential-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Essential R" />
  
  
  

<meta name="author" content="Simon Dirmeier">


<meta name="date" content="2018-10-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="plotting.html">
<link rel="next" href="mlr-and-openml.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-2.2.1/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.3/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.3/js/ggvis.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="_css/theme.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">essential-R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>1</b> R package development</a><ul>
<li class="chapter" data-level="1.1" data-path="r-package-development.html"><a href="r-package-development.html#creating-r-packages"><i class="fa fa-check"></i><b>1.1</b> Creating R packages</a></li>
<li class="chapter" data-level="1.2" data-path="r-package-development.html"><a href="r-package-development.html#writing-r-packages"><i class="fa fa-check"></i><b>1.2</b> Writing R packages</a></li>
<li class="chapter" data-level="1.3" data-path="r-package-development.html"><a href="r-package-development.html#testing-code"><i class="fa fa-check"></i><b>1.3</b> Testing code</a></li>
<li class="chapter" data-level="1.4" data-path="r-package-development.html"><a href="r-package-development.html#documenting-code"><i class="fa fa-check"></i><b>1.4</b> Documenting code</a></li>
<li class="chapter" data-level="1.5" data-path="r-package-development.html"><a href="r-package-development.html#checking-code"><i class="fa fa-check"></i><b>1.5</b> Checking code</a></li>
<li class="chapter" data-level="1.6" data-path="r-package-development.html"><a href="r-package-development.html#static-code-analysis"><i class="fa fa-check"></i><b>1.6</b> Static code analysis</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-package-development.html"><a href="r-package-development.html#running-examples"><i class="fa fa-check"></i><b>1.6.1</b> Running examples</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-package-development.html"><a href="r-package-development.html#code-coverage"><i class="fa fa-check"></i><b>1.7</b> Code coverage</a></li>
<li class="chapter" data-level="1.8" data-path="r-package-development.html"><a href="r-package-development.html#profiling-and-benchmarking"><i class="fa fa-check"></i><b>1.8</b> Profiling and benchmarking</a></li>
<li class="chapter" data-level="1.9" data-path="r-package-development.html"><a href="r-package-development.html#creating-a-landing-page"><i class="fa fa-check"></i><b>1.9</b> Creating a landing page</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html"><i class="fa fa-check"></i><b>2</b> Programming paradigma in R</a><ul>
<li class="chapter" data-level="2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#functional-programming"><i class="fa fa-check"></i><b>2.1</b> Functional programming</a></li>
<li class="chapter" data-level="2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#object-oriented-programming"><i class="fa fa-check"></i><b>2.2</b> Object-oriented programming</a><ul>
<li class="chapter" data-level="2.2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s3"><i class="fa fa-check"></i><b>2.2.1</b> S3</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s4"><i class="fa fa-check"></i><b>2.2.2</b> S4</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r5"><i class="fa fa-check"></i><b>2.2.3</b> R5</a></li>
<li class="chapter" data-level="2.2.4" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r6"><i class="fa fa-check"></i><b>2.2.4</b> R6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a></li>
<li class="chapter" data-level="4" data-path="extending-to-c-using-rcpp.html"><a href="extending-to-c-using-rcpp.html"><i class="fa fa-check"></i><b>4</b> Extending to C++ using Rcpp</a><ul>
<li class="chapter" data-level="4.1" data-path="extending-to-c-using-rcpp.html"><a href="extending-to-c-using-rcpp.html#rcpp-in-a-package"><i class="fa fa-check"></i><b>4.1</b> Rcpp in a package</a></li>
<li class="chapter" data-level="4.2" data-path="extending-to-c-using-rcpp.html"><a href="extending-to-c-using-rcpp.html#writing-c"><i class="fa fa-check"></i><b>4.2</b> Writing <code>C++</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional-programming-1.html"><a href="functional-programming-1.html"><i class="fa fa-check"></i><b>5</b> Functional programming</a></li>
<li class="chapter" data-level="6" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>6</b> Plotting</a><ul>
<li class="chapter" data-level="6.1" data-path="plotting.html"><a href="plotting.html#layout"><i class="fa fa-check"></i><b>6.1</b> Layout</a></li>
<li class="chapter" data-level="6.2" data-path="plotting.html"><a href="plotting.html#publication-ready-plots"><i class="fa fa-check"></i><b>6.2</b> Publication ready plots</a></li>
<li class="chapter" data-level="6.3" data-path="plotting.html"><a href="plotting.html#colors"><i class="fa fa-check"></i><b>6.3</b> Colors</a></li>
<li class="chapter" data-level="6.4" data-path="plotting.html"><a href="plotting.html#interactive-and-animated-plots"><i class="fa fa-check"></i><b>6.4</b> Interactive and animated plots</a></li>
<li class="chapter" data-level="6.5" data-path="plotting.html"><a href="plotting.html#graphs"><i class="fa fa-check"></i><b>6.5</b> Graphs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-table.html"><a href="data-table.html"><i class="fa fa-check"></i><b>7</b> data.table</a></li>
<li class="chapter" data-level="8" data-path="mlr-and-openml.html"><a href="mlr-and-openml.html"><i class="fa fa-check"></i><b>8</b> mlR and openML</a></li>
<li class="chapter" data-level="9" data-path="markdown-and-shiny.html"><a href="markdown-and-shiny.html"><i class="fa fa-check"></i><b>9</b> Markdown and Shiny</a><ul>
<li class="chapter" data-level="9.1" data-path="markdown-and-shiny.html"><a href="markdown-and-shiny.html#shiny"><i class="fa fa-check"></i><b>9.1</b> Shiny</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pryr.html"><a href="pryr.html"><i class="fa fa-check"></i><b>10</b> Pryr</a></li>
<li class="chapter" data-level="11" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>11</b> datastructures</a></li>
<li class="chapter" data-level="12" data-path="workflow-management.html"><a href="workflow-management.html"><i class="fa fa-check"></i><b>12</b> Workflow management</a></li>
<li class="chapter" data-level="13" data-path="others.html"><a href="others.html"><i class="fa fa-check"></i><b>13</b> Others</a></li>
<li class="chapter" data-level="14" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>14</b> Good practices</a><ul>
<li class="chapter" data-level="14.1" data-path="good-practices.html"><a href="good-practices.html#continuous-integration"><i class="fa fa-check"></i><b>14.1</b> Continuous integration</a></li>
<li class="chapter" data-level="14.2" data-path="good-practices.html"><a href="good-practices.html#version-control"><i class="fa fa-check"></i><b>14.2</b> Version control</a></li>
<li class="chapter" data-level="14.3" data-path="good-practices.html"><a href="good-practices.html#docker"><i class="fa fa-check"></i><b>14.3</b> Docker</a></li>
<li class="chapter" data-level="14.4" data-path="good-practices.html"><a href="good-practices.html#code-style"><i class="fa fa-check"></i><b>14.4</b> Code style</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essential R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data.table" class="section level1">
<h1><span class="header-section-number">7</span> data.table</h1>
<p><code>data.table</code> is a fast implementation of R’s classical <code>data.frame</code>. I hardly ever use data frame any more, and if so only, because it seems to work nicer with <code>dplyr</code> and <code>tidyr</code>. However, by using <code>dtplyr</code> this isn’t much of a problem, really.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;data.table&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dtplyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;grid&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gridExtra&quot;</span>)

n &lt;-<span class="st"> </span><span class="dv">1000</span>
rn &lt;-<span class="st"> </span>stats::<span class="kw">rnorm</span>(n)
ltrs &lt;-<span class="st"> </span>base::<span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">5</span>], n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
dt &lt;-<span class="st"> </span>data.table::<span class="kw">data.table</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)
df &lt;-<span class="st"> </span>base::<span class="kw">data.frame</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)

dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)] %&gt;%<span class="st"> </span><span class="kw">tableGrob</span>(<span class="dt">rows =</span> <span class="ot">NULL</span>) %&gt;%<span class="st"> </span>grid.arrange</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-32-1.png" width="192" style="display: block; margin: auto;" /></p>
<p>In the end it depends what style you prefer. I usually go with <code>data.table</code> alone without needing the <code>dplyr/dtplyr</code> dependency. However, the latter is usually more readable. For large data, the fastest solution is probably preferable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt.only &lt;-<span class="st"> </span>function() dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)]
dt.dtplyr &lt;-<span class="st"> </span>function() dt %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)
df.dplyr &lt;-<span class="st"> </span>function() df %&gt;%<span class="st"> </span>dplyr::<span class="kw">group_by</span>(Y) %&gt;%<span class="st"> </span>dplyr::<span class="kw">sample_n</span>(<span class="dv">1</span>)

microbenchmark::<span class="kw">microbenchmark</span>(<span class="kw">dt.only</span>(), <span class="kw">dt.dtplyr</span>(), <span class="kw">df.dplyr</span>())</code></pre></div>
<pre><code>Unit: milliseconds
        expr      min       lq     mean   median       uq       max neval
   dt.only() 1.523899 1.865236 2.599876 2.288431 2.856858  9.461022   100
 dt.dtplyr() 2.433177 2.924024 3.719260 3.596243 4.181204  9.954025   100
  df.dplyr() 1.513605 1.973985 2.643341 2.309220 2.675211 15.509272   100
 cld
  a 
   b
  a </code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mlr-and-openml.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
